这是我的给你的日志信息：[{"eventId":"0","iTraceId":"","module":"CONFIG_API_GZ_3","requestPkg":"{\"action\":\"DescribeConfigRule\",\"region\":\"\",\"token\":\"\",\"version\":\"\",\"requestId\":\"20250527153639-39rsEggWsqhuwmQ7E551p\",\"appId\":\"0\",\"uin\":\"100019718816\",\"subAccountUin\":\"\",\"clientIp\":\"\",\"camContext\":\"\",\"ruleId\":\"cr-66jqHZInKjYVhS6arKVP\"}","__TAG__":{"pod_label_cloud-tencent-com/instance-type":"S4.2XLARGE16","pod_label_qcloud-app":"config-api-gz-3","pod_label_tkex-workload-kind":"statefulsetplus","pod_label_controller-revision-hash":"config-api-gz-3-859c446df7","pod_label_cloud-tencent-com/asset-code":"","pod_label_k8s-app":"config-api-gz-3","pod_uid":"3ac19cdd-20e0-492f-b4f1-2160b51365b8","pod_ip":"30.49.184.19","pod_label_clusterId":"cls-4g9b5b18","pod_label_tkex-workload-name":"config-api-gz-3","pod_name":"config-api-gz-3-2","pod_label_tkex-projectName":"prj7849s","image_name":"csighub.tencentyun.com/tencent-cloud-platform/config_api:release_zefinnhao_20250410_173839","cluster_id":"cls-4g9b5b18","pod_label_env":"production","container_name":"config-api-gz-3","pod_label_cloud-tencent-com/pool":"qcloud","pod_label_moduleFourId":"2897822","namespace":"ns-prj7849s-2897822-production","pod_label_statefulsetplus-kubernetes-io/pod-name":"config-api-gz-3-2","pod_label_region":"ap-guangzhou","pod_label_workload-kind":"statefulsetplus","pod_label_projectName":"prj7849s"},"returnCode":"0","caller":"config_rule_engine","returnMsg":"ok","responsePkg":"","unixtimestamp":"1748331399","serverAddr":"30.49.184.19","service":"config_api","clientIp":"30.167.66.50","action":"/DescribeConfigRule","uin":"","timeCost":"27254","reporterType":"0"},{"eventId":"0","iTraceId":"","module":"CONFIG_API_GZ_4","requestPkg":"{\"action\":\"DescribeConfigRule\",\"region\":\"\",\"token\":\"\",\"version\":\"\",\"requestId\":\"20250527153639-hMjCRl4QJecdTq6tZzr6p\",\"appId\":\"0\",\"uin\":\"100019718816\",\"subAccountUin\":\"\",\"clientIp\":\"\",\"camContext\":\"\",\"ruleId\":\"cr-66jqHZInKjYVhS6arKVP\"}","__TAG__":{"pod_label_cloud-tencent-com/instance-type":"SA2.2XLARGE16","pod_label_qcloud-app":"config-api-gz-4","pod_label_tkex-workload-kind":"statefulsetplus","pod_label_controller-revision-hash":"config-api-gz-4-6d58646fb7","pod_label_cloud-tencent-com/asset-code":"","pod_label_k8s-app":"config-api-gz-4","pod_uid":"98398a7d-bc03-4a44-9c10-3ebed2d73fa4","pod_ip":"21.10.174.2","pod_label_clusterId":"cls-pm40lmeq","pod_label_tkex-workload-name":"config-api-gz-4","pod_name":"config-api-gz-4-2","pod_label_tkex-projectName":"prj7849s","image_name":"csighub.tencentyun.com/tencent-cloud-platform/config_api:release_zefinnhao_20250410_173839","cluster_id":"cls-pm40lmeq","pod_label_env":"production","container_name":"config-api-gz-4","pod_label_cloud-tencent-com/pool":"qcloud","pod_label_moduleFourId":"2897822","namespace":"ns-prj7849s-2897822-production","pod_label_statefulsetplus-kubernetes-io/pod-name":"config-api-gz-4-2","pod_label_region":"ap-guangzhou","pod_label_workload-kind":"statefulsetplus","pod_label_projectName":"prj7849s"},"returnCode":"0","caller":"config_rule_engine","returnMsg":"ok","responsePkg":"","unixtimestamp":"1748331399","serverAddr":"21.10.174.2","service":"config_api","clientIp":"30.167.66.50","action":"/DescribeConfigRule","uin":"","timeCost":"6292","reporterType":"0"},{"eventId":"0","iTraceId":"","module":"CONFIG_API_GZ_3","requestPkg":"{\"action\":\"DescribeConfigRule\",\"region\":\"\",\"token\":\"\",\"version\":\"\",\"requestId\":\"20250527153638-STjKSMLDdFjVFOPzLEhFy\",\"appId\":\"0\",\"uin\":\"100019718816\",\"subAccountUin\":\"\",\"clientIp\":\"\",\"camContext\":\"\",\"ruleId\":\"cr-66jqHZInKjYVhS6arKVP\"}","__TAG__":{"pod_label_cloud-tencent-com/instance-type":"S3.2XLARGE16","pod_label_qcloud-app":"config-api-gz-3","pod_label_tkex-workload-kind":"statefulsetplus","pod_label_controller-revision-hash":"config-api-gz-3-859c446df7","pod_label_cloud-tencent-com/asset-code":"","pod_label_k8s-app":"config-api-gz-3","pod_uid":"d5732f41-9747-4821-8b93-4194a20a1c98","pod_ip":"30.45.9.108","pod_label_clusterId":"cls-4g9b5b18","pod_label_tkex-workload-name":"config-api-gz-3","pod_name":"config-api-gz-3-3","pod_label_tkex-projectName":"prj7849s","image_name":"csighub.tencentyun.com/tencent-cloud-platform/config_api:release_zefinnhao_20250410_173839","cluster_id":"cls-4g9b5b18","pod_label_env":"production","container_name":"config-api-gz-3","pod_label_cloud-tencent-com/pool":"qcloud","pod_label_moduleFourId":"2897822","namespace":"ns-prj7849s-2897822-production","pod_label_statefulsetplus-kubernetes-io/pod-name":"config-api-gz-3-3","pod_label_region":"ap-guangzhou","pod_label_workload-kind":"statefulsetplus","pod_label_projectName":"prj7849s"},"returnCode":"0","caller":"config_rule_engine","returnMsg":"ok","responsePkg":"","unixtimestamp":"1748331398","serverAddr":"30.45.9.108","service":"config_api","clientIp":"30.167.66.50","action":"/DescribeConfigRule","uin":"","timeCost":"25388","reporterType":"0"},{"eventId":"0","iTraceId":"","module":"CONFIG_API_GZ_3","requestPkg":"{\"action\":\"DescribeConfigRule\",\"region\":\"\",\"token\":\"\",\"version\":\"\",\"requestId\":\"20250527153638-LWkfH3CRdy4EYTzjSar8t\",\"appId\":\"0\",\"uin\":\"100019718816\",\"subAccountUin\":\"\",\"clientIp\":\"\",\"camContext\":\"\",\"ruleId\":\"cr-66jqHZInKjYVhS6arKVP\"}","__TAG__":{"pod_label_cloud-tencent-com/instance-type":"S3.2XLARGE16","pod_label_qcloud-app":"config-api-gz-3","pod_label_tkex-workload-kind":"statefulsetplus","pod_label_controller-revision-hash":"config-api-gz-3-859c446df7","pod_label_cloud-tencent-com/asset-code":"","pod_label_k8s-app":"config-api-gz-3","pod_uid":"d5732f41-9747-4821-8b93-4194a20a1c98","pod_ip":"30.45.9.108","pod_label_clusterId":"cls-4g9b5b18","pod_label_tkex-workload-name":"config-api-gz-3","pod_name":"config-api-gz-3-3","pod_label_tkex-projectName":"prj7849s","image_name":"csighub.tencentyun.com/tencent-cloud-platform/config_api:release_zefinnhao_20250410_173839","cluster_id":"cls-4g9b5b18","pod_label_env":"production","container_name":"config-api-gz-3","pod_label_cloud-tencent-com/pool":"qcloud","pod_label_moduleFourId":"2897822","namespace":"ns-prj7849s-2897822-production","pod_label_statefulsetplus-kubernetes-io/pod-name":"config-api-gz-3-3","pod_label_region":"ap-guangzhou","pod_label_workload-kind":"statefulsetplus","pod_label_projectName":"prj7849s"},"returnCode":"0","caller":"config_rule_engine","returnMsg":"ok","responsePkg":"","unixtimestamp":"1748331398","serverAddr":"30.45.9.108","service":"config_api","clientIp":"30.167.66.50","action":"/DescribeConfigRule","uin":"","timeCost":"26855","reporterType":"0"},{"eventId":"0","iTraceId":"","module":"CONFIG_API_GZ_3","requestPkg":"{\"action\":\"DescribeConfigRule\",\"region\":\"\",\"token\":\"\",\"version\":\"\",\"requestId\":\"20250527153638-8YLsV9psS7c2V4ETgm0pO\",\"appId\":\"0\",\"uin\":\"100019718816\",\"subAccountUin\":\"\",\"clientIp\":\"\",\"camContext\":\"\",\"ruleId\":\"cr-wELDMsHCKuX21LgzMT7X\"}","__TAG__":{"pod_label_cloud-tencent-com/instance-type":"S3.2XLARGE16","pod_label_qcloud-app":"config-api-gz-3","pod_label_tkex-workload-kind":"statefulsetplus","pod_label_controller-revision-hash":"config-api-gz-3-859c446df7","pod_label_cloud-tencent-com/asset-code":"","pod_label_k8s-app":"config-api-gz-3","pod_uid":"d5732f41-9747-4821-8b93-4194a20a1c98","pod_ip":"30.45.9.108","pod_label_clusterId":"cls-4g9b5b18","pod_label_tkex-workload-name":"config-api-gz-3","pod_name":"config-api-gz-3-3","pod_label_tkex-projectName":"prj7849s","image_name":"csighub.tencentyun.com/tencent-cloud-platform/config_api:release_zefinnhao_20250410_173839","cluster_id":"cls-4g9b5b18","pod_label_env":"production","container_name":"config-api-gz-3","pod_label_cloud-tencent-com/pool":"qcloud","pod_label_moduleFourId":"2897822","namespace":"ns-prj7849s-2897822-production","pod_label_statefulsetplus-kubernetes-io/pod-name":"config-api-gz-3-3","pod_label_region":"ap-guangzhou","pod_label_workload-kind":"statefulsetplus","pod_label_projectName":"prj7849s"},"returnCode":"0","caller":"config_rule_engine","returnMsg":"ok","responsePkg":"","unixtimestamp":"1748331398","serverAddr":"30.45.9.108","service":"config_api","clientIp":"30.167.66.50","action":"/DescribeConfigRule","uin":"","timeCost":"22491","reporterType":"0"},{"eventId":"0","iTraceId":"","module":"CONFIG_API_GZ_3","requestPkg":"{\"action\":\"DescribeConfigRule\",\"region\":\"\",\"token\":\"\",\"version\":\"\",\"requestId\":\"20250527153638-6djBeXqQe3950bjyGwMu0\",\"appId\":\"0\",\"uin\":\"100019718816\",\"subAccountUin\":\"\",\"clientIp\":\"\",\"camContext\":\"\",\"ruleId\":\"cr-wELDMsHCKuX21LgzMT7X\"}","__TAG__":{"pod_label_cloud-tencent-com/instance-type":"S3.2XLARGE16","pod_label_qcloud-app":"config-api-gz-3","pod_label_tkex-workload-kind":"statefulsetplus","pod_label_controller-revision-hash":"config-api-gz-3-859c446df7","pod_label_cloud-tencent-com/asset-code":"","pod_label_k8s-app":"config-api-gz-3","pod_uid":"d5732f41-9747-4821-8b93-4194a20a1c98","pod_ip":"30.45.9.108","pod_label_clusterId":"cls-4g9b5b18","pod_label_tkex-workload-name":"config-api-gz-3","pod_name":"config-api-gz-3-3","pod_label_tkex-projectName":"prj7849s","image_name":"csighub.tencentyun.com/tencent-cloud-platform/config_api:release_zefinnhao_20250410_173839","cluster_id":"cls-4g9b5b18","pod_label_env":"production","container_name":"config-api-gz-3","pod_label_cloud-tencent-com/pool":"qcloud","pod_label_moduleFourId":"2897822","namespace":"ns-prj7849s-2897822-production","pod_label_statefulsetplus-kubernetes-io/pod-name":"config-api-gz-3-3","pod_label_region":"ap-guangzhou","pod_label_workload-kind":"statefulsetplus","pod_label_projectName":"prj7849s"},"returnCode":"0","caller":"config_rule_engine","returnMsg":"ok","responsePkg":"","unixtimestamp":"1748331398","serverAddr":"30.45.9.108","service":"config_api","clientIp":"30.167.66.50","action":"/DescribeConfigRule","uin":"","timeCost":"19566","reporterType":"0"},{"eventId":"0","iTraceId":"","module":"CONFIG_API_GZ_3","requestPkg":"{\"action\":\"DescribeConfigRule\",\"region\":\"\",\"token\":\"\",\"version\":\"\",\"requestId\":\"20250527153638-3yyvAN5PXDD6AeJmqo5tN\",\"appId\":\"0\",\"uin\":\"100019718816\",\"subAccountUin\":\"\",\"clientIp\":\"\",\"camContext\":\"\",\"ruleId\":\"cr-66jqHZInKjYVhS6arKVP\"}","__TAG__":{"pod_label_cloud-tencent-com/instance-type":"S3.2XLARGE16","pod_label_qcloud-app":"config-api-gz-3","pod_label_tkex-workload-kind":"statefulsetplus","pod_label_controller-revision-hash":"config-api-gz-3-859c446df7","pod_label_cloud-tencent-com/asset-code":"","pod_label_k8s-app":"config-api-gz-3","pod_uid":"89e5ced1-9386-4ae9-b850-d452245bf7cb","pod_ip":"30.49.108.27","pod_label_clusterId":"cls-4g9b5b18","pod_label_tkex-workload-name":"config-api-gz-3","pod_name":"config-api-gz-3-1","pod_label_tkex-projectName":"prj7849s","image_name":"csighub.tencentyun.com/tencent-cloud-platform/config_api:release_zefinnhao_20250410_173839","cluster_id":"cls-4g9b5b18","pod_label_env":"production","container_name":"config-api-gz-3","pod_label_cloud-tencent-com/pool":"qcloud_ziyan_eks","pod_label_moduleFourId":"2897822","namespace":"ns-prj7849s-2897822-production","pod_label_statefulsetplus-kubernetes-io/pod-name":"config-api-gz-3-1","pod_label_region":"ap-guangzhou","pod_label_workload-kind":"statefulsetplus","pod_label_projectName":"prj7849s"},"returnCode":"0","caller":"config_rule_engine","returnMsg":"ok","responsePkg":"","unixtimestamp":"1748331398","serverAddr":"30.49.108.27","service":"config_api","clientIp":"30.167.66.50","action":"/DescribeConfigRule","uin":"","timeCost":"27926","reporterType":"0"},{"eventId":"0","iTraceId":"","module":"CONFIG_API_GZ_4","requestPkg":"{\"action\":\"DescribeConfigRule\",\"region\":\"\",\"token\":\"\",\"version\":\"\",\"requestId\":\"20250527153638-5zYS4r9C0KVVUKWwPfaHI\",\"appId\":\"0\",\"uin\":\"100019718816\",\"subAccountUin\":\"\",\"clientIp\":\"\",\"camContext\":\"\",\"ruleId\":\"cr-66jqHZInKjYVhS6arKVP\"}","__TAG__":{"pod_label_cloud-tencent-com/instance-type":"SA2.2XLARGE16","pod_label_qcloud-app":"config-api-gz-4","pod_label_tkex-workload-kind":"statefulsetplus","pod_label_controller-revision-hash":"config-api-gz-4-6d58646fb7","pod_label_cloud-tencent-com/asset-code":"","pod_label_k8s-app":"config-api-gz-4","pod_uid":"08edb96b-1b38-4d31-b781-d11d2e8ea074","pod_ip":"21.18.97.109","pod_label_clusterId":"cls-pm40lmeq","pod_label_tkex-workload-name":"config-api-gz-4","pod_name":"config-api-gz-4-3","pod_label_tkex-projectName":"prj7849s","image_name":"csighub.tencentyun.com/tencent-cloud-platform/config_api:release_zefinnhao_20250410_173839","cluster_id":"cls-pm40lmeq","pod_label_env":"production","container_name":"config-api-gz-4","pod_label_cloud-tencent-com/pool":"qcloud","pod_label_moduleFourId":"2897822","namespace":"ns-prj7849s-2897822-production","pod_label_statefulsetplus-kubernetes-io/pod-name":"config-api-gz-4-3","pod_label_region":"ap-guangzhou","pod_label_workload-kind":"statefulsetplus","pod_label_projectName":"prj7849s"},"returnCode":"0","caller":"config_rule_engine","returnMsg":"ok","responsePkg":"","unixtimestamp":"1748331398","serverAddr":"21.18.97.109","service":"config_api","clientIp":"30.167.66.50","action":"/DescribeConfigRule","uin":"","timeCost":"6006","reporterType":"0"},{"eventId":"0","iTraceId":"","module":"CONFIG_API_GZ_3","requestPkg":"{\"action\":\"DescribeConfigRule\",\"region\":\"\",\"token\":\"\",\"version\":\"\",\"requestId\":\"20250527153638-UJwGzNm19F9fIE9NFUM1a\",\"appId\":\"0\",\"uin\":\"100019718816\",\"subAccountUin\":\"\",\"clientIp\":\"\",\"camContext\":\"\",\"ruleId\":\"cr-66jqHZInKjYVhS6arKVP\"}","__TAG__":{"pod_label_cloud-tencent-com/instance-type":"S3.2XLARGE16","pod_label_qcloud-app":"config-api-gz-3","pod_label_tkex-workload-kind":"statefulsetplus","pod_label_controller-revision-hash":"config-api-gz-3-859c446df7","pod_label_cloud-tencent-com/asset-code":"","pod_label_k8s-app":"config-api-gz-3","pod_uid":"51529128-a708-459b-b7c4-4ccf079c328b","pod_ip":"9.148.247.252","pod_label_clusterId":"cls-4g9b5b18","pod_label_tkex-workload-name":"config-api-gz-3","pod_name":"config-api-gz-3-0","pod_label_tkex-projectName":"prj7849s","image_name":"csighub.tencentyun.com/tencent-cloud-platform/config_api:release_zefinnhao_20250410_173839","cluster_id":"cls-4g9b5b18","pod_label_env":"production","container_name":"config-api-gz-3","pod_label_cloud-tencent-com/pool":"qcloud_ziyan_eks","pod_label_moduleFourId":"2897822","namespace":"ns-prj7849s-2897822-production","pod_label_statefulsetplus-kubernetes-io/pod-name":"config-api-gz-3-0","pod_label_region":"ap-guangzhou","pod_label_workload-kind":"statefulsetplus","pod_label_projectName":"prj7849s"},"returnCode":"0","caller":"config_rule_engine","returnMsg":"ok","responsePkg":"","unixtimestamp":"1748331398","serverAddr":"9.148.247.252","service":"config_api","clientIp":"30.167.66.50","action":"/DescribeConfigRule","uin":"","timeCost":"26431","reporterType":"0"},{"eventId":"0","iTraceId":"","module":"CONFIG_API_GZ_3","requestPkg":"{\"action\":\"DescribeConfigRule\",\"region\":\"\",\"token\":\"\",\"version\":\"\",\"requestId\":\"20250527153638-hX5GdA1MEhwVBOUH3ZM2k\",\"appId\":\"0\",\"uin\":\"100019718816\",\"subAccountUin\":\"\",\"clientIp\":\"\",\"camContext\":\"\",\"ruleId\":\"cr-66jqHZInKjYVhS6arKVP\"}","__TAG__":{"pod_label_cloud-tencent-com/instance-type":"S3.2XLARGE16","pod_label_qcloud-app":"config-api-gz-3","pod_label_tkex-workload-kind":"statefulsetplus","pod_label_controller-revision-hash":"config-api-gz-3-859c446df7","pod_label_cloud-tencent-com/asset-code":"","pod_label_k8s-app":"config-api-gz-3","pod_uid":"51529128-a708-459b-b7c4-4ccf079c328b","pod_ip":"9.148.247.252","pod_label_clusterId":"cls-4g9b5b18","pod_label_tkex-workload-name":"config-api-gz-3","pod_name":"config-api-gz-3-0","pod_label_tkex-projectName":"prj7849s","image_name":"csighub.tencentyun.com/tencent-cloud-platform/config_api:release_zefinnhao_20250410_173839","cluster_id":"cls-4g9b5b18","pod_label_env":"production","container_name":"config-api-gz-3","pod_label_cloud-tencent-com/pool":"qcloud_ziyan_eks","pod_label_moduleFourId":"2897822","namespace":"ns-prj7849s-2897822-production","pod_label_statefulsetplus-kubernetes-io/pod-name":"config-api-gz-3-0","pod_label_region":"ap-guangzhou","pod_label_workload-kind":"statefulsetplus","pod_label_projectName":"prj7849s"},"returnCode":"0","caller":"config_rule_engine","returnMsg":"ok","responsePkg":"","unixtimestamp":"1748331398","serverAddr":"9.148.247.252","service":"config_api","clientIp":"30.167.66.50","action":"/DescribeConfigRule","uin":"","timeCost":"27679","reporterType":"0"}]


curl 'https://simqry2.eastmoney.com/qry_tzzh_v2?type=spo_rank_syl&plat=2&ver=web20&utToken=&ctToken=&sylType=10001&recIdx=1&recCnt=250&cb=jQuery112304628108748133831_1748348052065&_=1748348052066' \
  -H 'Accept: */*' \
  -H 'Accept-Language: zh-CN,zh;q=0.9,en;q=0.8' \
  -H 'Connection: keep-alive' \
  -b 'qgqp_b_id=c1b5f818e1b7bb024cbe5457f6f1ea69; st_si=08770639335019; HAList=ty-0-300255-%u5E38%u5C71%u836F%u4E1A; fullscreengg=1; fullscreengg2=1; st_pvi=05347401450250; st_sp=2025-05-27%2019%3A36%3A52; st_inirUrl=https%3A%2F%2Fquote.eastmoney.com%2Fredirect.html; st_sn=1; st_psi=20250527193651805-113200301201-1505707756; st_asi=delete' \
  -H 'Referer: https://group.eastmoney.com/mcombin,10001.html' \
  -H 'Sec-Fetch-Dest: script' \
  -H 'Sec-Fetch-Mode: no-cors' \
  -H 'Sec-Fetch-Site: same-site' \
  -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36' \
  -H 'sec-ch-ua: "Chromium";v="136", "Google Chrome";v="136", "Not.A/Brand";v="99"' \
  -H 'sec-ch-ua-mobile: ?0' \
  -H 'sec-ch-ua-platform: "macOS"'

-- 全量三表关联
SELECT 
    d.service AS 接口服务,
    d.action AS 接口名,
    JSON_ARRAYAGG(
        JSON_OBJECT(
            'name', p.para_name,
            'type', p.param_type,
            'description', IFNULL(p.description, ''),
            'example', IFNULL(p.example_value, ''),
            'is_sensitive', p.is_sensitive
        )
    ) AS 接口参数,
    d.interface_desc AS 接口描述
FROM 
    api_interface_doc_distinct d
LEFT JOIN 
    api_response_params p ON d.id = p.interface_id
GROUP BY 
    d.id, d.service, d.action, d.interface_desc
ORDER BY 
    d.action asc
LIMIT 0, 500;

SELECT 
    d.service AS 接口服务,
    d.action AS 接口名,
    JSON_ARRAYAGG(
        JSON_OBJECT(
            'name', p.para_name,
            'type', p.param_type,
            'description', IFNULL(p.description, ''),
            'example', IFNULL(p.example_value, ''),
            'is_sensitive', p.is_sensitive
        )
    ) AS 接口参数,
    d.interface_desc AS 接口描述
FROM 
    api_interface_doc_distinct d
LEFT JOIN 
    api_response_params p ON d.id = p.interface_id
GROUP BY 
    d.id, d.service, d.action, d.interface_desc
ORDER BY 
    d.action asc
LIMIT 500, 500;

SELECT 
    d.service AS 接口服务,
    d.action AS 接口名,
    JSON_ARRAYAGG(
        JSON_OBJECT(
            'name', p.para_name,
            'type', p.param_type,
            'description', IFNULL(p.description, ''),
            'example', IFNULL(p.example_value, ''),
            'is_sensitive', p.is_sensitive
        )
    ) AS 接口参数,
    d.interface_desc AS 接口描述
FROM 
    api_interface_doc_distinct d
LEFT JOIN 
    api_response_params p ON d.id = p.interface_id
GROUP BY 
    d.id, d.service, d.action, d.interface_desc
ORDER BY 
    d.action asc
LIMIT 1000, 500;

SELECT 
    d.service AS 接口服务,
    d.action AS 接口名,
    JSON_ARRAYAGG(
        JSON_OBJECT(
            'name', p.para_name,
            'type', p.param_type,
            'description', IFNULL(p.description, ''),
            'example', IFNULL(p.example_value, ''),
            'is_sensitive', p.is_sensitive
        )
    ) AS 接口参数,
    d.interface_desc AS 接口描述
FROM 
    api_interface_doc_distinct d
LEFT JOIN 
    api_response_params p ON d.id = p.interface_id
GROUP BY 
    d.id, d.service, d.action, d.interface_desc
ORDER BY 
    d.action asc
LIMIT 1500, 500;

-- 敏感三表关联
SELECT 
    d.service AS 接口服务,
    d.action AS 接口名,
    JSON_ARRAYAGG(
        JSON_OBJECT(
            'name', p.para_name,
            'type', p.param_type,
            'description', IFNULL(p.description, ''),
            'example', IFNULL(p.example_value, ''),
            'is_sensitive', p.is_sensitive
        )
    ) AS 接口参数,
    d.interface_desc AS 接口描述,
    r.reason AS 敏感原因,
    r.sensitive_type AS 敏感类型,
    r.related_tables AS 关联表,
    r.confirmed AS 是否已确认
FROM 
    api_interface_doc_distinct d
INNER JOIN 
    interface_risk_sensitive_doc_v2 r ON d.action = r.interface
LEFT JOIN 
    api_response_params p ON d.id = p.interface_id
WHERE 
    r.is_sensitive = 1
GROUP BY 
    d.id, d.service, d.action, d.interface_desc,
    r.reason, r.sensitive_type, r.related_tables, r.confirmed
ORDER BY 
    r.confirmed ASC, d.id DESC
LIMIT 0,500;

SELECT 
    d.service AS 接口服务,
    d.action AS 接口名,
    JSON_ARRAYAGG(
        JSON_OBJECT(
            'name', p.para_name,
            'type', p.param_type,
            'description', IFNULL(p.description, ''),
            'example', IFNULL(p.example_value, ''),
            'is_sensitive', p.is_sensitive
        )
    ) AS 接口参数,
    d.interface_desc AS 接口描述,
    r.reason AS 敏感原因,
    r.sensitive_type AS 敏感类型,
    r.related_tables AS 关联表,
    r.confirmed AS 是否已确认
FROM 
    api_interface_doc_distinct d
INNER JOIN 
    interface_risk_sensitive_doc_v2 r ON d.action = r.interface
LEFT JOIN 
    api_response_params p ON d.id = p.interface_id
WHERE 
    r.is_sensitive = 1
GROUP BY 
    d.id, d.service, d.action, d.interface_desc,
    r.reason, r.sensitive_type, r.related_tables, r.confirmed
ORDER BY 
    r.confirmed ASC, d.id DESC
LIMIT 500,500;

-- 高危三表关联
SELECT 
    d.service AS 接口服务,
    d.action AS 接口名,
    JSON_ARRAYAGG(
        JSON_OBJECT(
            'name', p.para_name,
            'type', p.param_type,
            'description', IFNULL(p.description, ''),
            'is_sensitive', p.is_sensitive
        )
    ) AS 接口参数,
    d.interface_desc AS 接口描述,
    r.reason AS 高危原因,
    r.risk_type AS 高危类型,
    r.related_tables AS 关联表
FROM 
    api_interface_doc_distinct d
LEFT JOIN 
    api_response_params p ON d.id = p.interface_id
JOIN 
    interface_risk_sensitive_doc_v2 r ON d.action = r.interface
WHERE 
    r.is_high_risk = 1
GROUP BY 
    d.id, d.service, d.action, d.interface_desc,
    r.reason, r.risk_type, r.related_tables
LIMIT 500;





----- 


SELECT
    COUNT(1) AS total,
    SUM(CASE WHEN is_high_risk = 1 THEN 1 ELSE 0 END) AS risk_count,
    COUNT(1) - SUM(CASE WHEN is_high_risk = 1 THEN 1 ELSE 0 END) AS risk_difference,
    SUM(CASE WHEN is_sensitive = 1 THEN 1 ELSE 0 END) AS sensitive_count,
    COUNT(1) - SUM(CASE WHEN is_sensitive = 1 THEN 1 ELSE 0 END) AS sensitive_difference
FROM interface_risk_sensitive_doc_v2 LIMIT 1;

SELECT COUNT(1) from interface_risk_sensitive_doc_distinct where is_high_risk = 1 LIMIT 1;

SELECT * from interface_risk_sensitive_doc_v2 where is_sensitive = 1 order by create_time limit 250;

SELECT * from interface_risk_sensitive_doc_v2 where is_high_risk = 1 ORDER BY create_time desc LIMIT 200 ;

some ques:
1. 接口表，根据condition筛选出符合的接口
  - 接口表去哪里获得
  - condition规则
    - 
2. 去TDW拿这些接口的日志，需要的字段有clientIp，requestPkg，interfaceName
3. 每个记录十条，写入数据库
4. 导出一份excel文档

SELECT uin,
       cientip,
       product,
       interface,
       code,
       timecost,
       get_json_object(response, '$.data.ownerUin') AS owinerUin,
       get_json_object(request, '$.interface.para.auth_token') AS auth_token,
       request,
       response,
       token,
       from_unixtime(logtime) as log_at
FROM csig_cam::sig_auth_comm_log
WHERE
    tdbank_imp_date = '${YYYYMMDDHH}'
  AND get_json_object(request, '$.interface.interfaceName') = 'logic.cam.checkResource'
  AND get_json_object(response, '$.data.ownerUin') = '1977869558' 
  AND get_json_object(concat('{\"arr\":', token, '}'), '$.arr[0].hasPolicyFilter') = 1
  AND (get_json_object(get_json_object(CONCAT('{\"arr\":', token, '}'), '$.arr[0].extraInfo'), '$.tokenType') is NULL
   or get_json_object(get_json_object(CONCAT('{\"arr\":', token, '}'), '$.arr[0].extraInfo'), '$.tokenType') != 9)
  AND (get_json_object(get_json_object(CONCAT('{\"arr\":', token, '}'), '$.arr[0].extraInfo'), '$.thOwnerUin') is NULL
   OR get_json_object(get_json_object(CONCAT('{\"arr\":', token, '}'), '$.arr[0].extraInfo'), '$.thOwnerUin') = '')



1. 修改Prompt，跑接口分类分级的文档数据
2. 修改cam_diff服务，增加北极星接入和多地址转发和某些字段的匹配逻辑，完善脚本
3. cam_diff服务增加一个udp_client，负责在开启时候从五分钟前开始读从cls读日志打成udp包发到cam_diff

CREATE DATASOURCE `interface_doc_db` WITH (
datasource=jdbc, 
url=`jdbc:supersql:datasource:url='jdbc:mysql://30.46.139.169:3306/interface_doc_db?characterEncoding=utf8&connectTimeout=30000';driver='com.mysql.jdbc.Driver';jarPath='./supersql-drivers.zip/mysql'`,
driver=`com.tencent.supersql.connector.SuperSqlDataSourceDriver`,
username=conf, 
password=`2j5O62RRV5aIeGLp`,
catalog=interface_doc_db,
type=mysql)




请用python。现在是这样，我希望从数据库表tdw_record中查询出数据是否大于10（根据product和interface），如果小于10，那么就拿product和interface去数仓查数据，然后插入到表中。
这是mysql数据库tdw_record的建表sql：
CREATE TABLE `tdw_record` (
                            `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID',
                            `uin` bigint DEFAULT NULL COMMENT '用户ID',
                            `client_ip` varchar(50) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '客户IP',
                            `product` varchar(255) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '产品',
                            `interface` varchar(255) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '接口',
                            `request` text COLLATE utf8mb4_unicode_ci COMMENT '请求数据',
                            `response` text COLLATE utf8mb4_unicode_ci COMMENT '响应数据',
                            `tdbank_impl_date` varchar(20) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '导入日期',
                            `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
                            `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
                            PRIMARY KEY (`id`),
                            KEY `idx_tdbank_impl_date` (`tdbank_impl_date`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='tdw记录表';
，代码我已经写了一些，可以给你参考：
def TDW_PL(tdw, argv):
    for product, interface in fetch_interface_list():
        sql = """
            select uin, cientip, product, interface, request, response, mode
            from csig_cam::sig_auth_comm_log
            where tdbank_imp_date > '2025050110' 
              and tdbank_imp_date < '20250503018'
              and product = '%s'
              and interface = '%s'
            limit 10
        """
        sql = sql % (product, interface)
        tdw.WriteLog(sql)
        res = tdw.execute(sql)
        tdw.WriteLog(res)

def select_interface(product, interface):
    sql = """
        select count(1) from interface_doc_db.`tdw_record` where product = '%s' and interface = '%s'
    """
     # sql = sql % (product, interface)
    res = tdw.execute(sql)
    tdw.WriteLog(res)

def fetch_interface_list():
    non_cloud_apis = """
        cvm:ResetInstances
        cvm:CheckSecurityGroupPolicyRedundancy
        cvm:DescribeInstancesOfferingsV3
        cvm:DescribeInstanceTypeQuotaV3
        cvm:DescribeZonesV3
        cvm:InquiryInstancePriceHour
        cvm:InquiryPriceAllocateHostsV3
        cvm:DescribeInstanceMainInfo
        cvm:DescribeInstanceStatisticsV3
        cvm:DescribeKeyPairsV3
        cvm:InquiryInstanceBandwidthConfig
        cvm:InquiryInstanceOrOSConfig
        cvm:InquiryPriceResetInstancesTypeV3
        cvm:DescribeDiskConfigQuota
        cvm:DescribeDiskFeatures
        cvm:DescribeDiskInitializationUserData
        cvm:DescribeDisksDeniedActions
        cvm:DescribeSnapshotGroupsDeniedActions
        cvm:DescribeSnapshotsDeniedActions
        cvm:GetSnapOverview
        cvm:DescribeInstanceTypeSalesConfig
        cvm:InquirePriceModifyDiskBackupQuota
        cvm:InquirePriceModifyDiskExtraPerformance
        cvm:InquirePriceRefundDisks
        cvm:InquiryPriceCreateDisks
        cvm:InquiryPriceModifyDiskAttributes
        cvm:InquiryPriceModifyDisksChargeType
        cvm:InquiryPriceRenewDisks
        cvm:InquiryPriceResizeDisk
        cvm:ModifyInstanceFamiliesAttribute
        cvm:SwitchParameterCreateDisks
        cvm:SwitchParameterModifyDiskAttributes
        cvm:SwitchParameterModifyDiskChargeType
        cvm:SwitchParameterModifyDiskExtraPerformance
        cvm:SwitchParameterRenewDisks
        cvm:SwitchParameterResizeDisk
        cvm:DescribeCbsOperationLogs
        cvm:ModifyInstanceTypeSalesConfig
        cvm:ModifyDiskRollbackType
    """

    cloud_apis = """
        cvm:DescribeInstanceBanInfo
        cvm:DescribeAddresses
        cvm:ReleaseAddresses
        cvm:AssociateAddress
        cvm:DisassociateAddress
        cvm:RenewAddresses
        cvm:ModifyAddressesBandwidth
        cvm:StopInstances
        cvm:TerminateInstances
        cvm:DescribeInstances
        cvm:DescribeInstancesStatus
        cvm:ResetInstance
        cvm:DescribeImages
        cvm:AllocateAddresses
    """

    return parse_apis(non_cloud_apis) + parse_apis(cloud_apis)


def parse_apis(api_string):
    """Parse API string and return formatted list of (product, interface) tuples"""
    apis = []
    for line in api_string.strip().split('\n'):
        line = line.strip()
        if line:
            product, interface = line.split(':')
            apis.append((product.strip(), interface.strip()))  # Using tuple instead of list
    return apis
我告诉你，tdw的返回数据格式是tsv的，比如我查询select count(1) from interface_doc_db.`tdw_record` where product = '%s' and interface = '%s'
这是res的打印结果：['1\t2710703044\t21.7.221.99\tcvm\tDescribeAddresses\t{"version":0,"eventId":1748563162,"timestamp":1748563162,"interface":{"interfaceName":"logic.cam.sigAndAuth","para":{"mode":2,"new_check_resource":1,"resource":"qcs::cvm:bj:uin\\/2710703044:eip\\/*","ownerUin":"2710703044","sub_condition":[],"uin":"2710703044","action":"cvm:DescribeAddresses"}}}\t{"version":"0","componentName":"mall_logic","timestamp":"0","eventId":1748563162,"returnValue":0,"returnCode":0,"returnMessage":"permission verify","data":{"ownerUin":2710703044,"uin":2710703044,"ownerAppid":0,"ownerUinStr":"2710703044","uinStr":"2710703044","ownerAppidStr":"0","keyType":0,"keySource":0,"formatString":"","stringToSign":"","permissionDetail":[],"transferDetail":[],"debugInfo":[],"accountArea":0}}\tNULL\t2025-05-30 18:33:53\t2025-05-30 18:33:53']，请你完成我的需求

使用AI写代码，我会先看需求是否复杂：
1. 简单的，只说重要的信息：比如用什么语言写，要做到什么，要求输出一个function然后修改
2. 略微复杂的，一般会新建一个Prompt文件，在内部给出输入输出和简单介绍需求，然后给AI处理，比如


「风险SQL治理&SQL注入防护」主题沙龙
风险sql的定义：
锁执行耗时
锁等待时间风险
扫描行数风险

sql风险 = 单sql执行成本 *  并发


Sql执行成本：
- 扫描的数据量、锁资源占用
- 排序连接聚合等工作量大

优化：
1. 索引优化：无索引导致全表扫描、低效索引导致扫描了大量不需要的数据
2. sql改造：
    1. 单sql返回大量数据
    2. 单sql更新、删除了大量数据
    3. count，distinct等针对大数据量进行计数、去重、聚合
    4. 深分页

并发：
1. 云API调用
    - 云API限频
    - 内部API限频
    - 慢SQL自动限流
    - 慢SQL手工限流 
2. 内部API调用

选择度

ICP，index condition pushdown， 索引下推

大sql拆分，在业务层聚合，好处是可以减少主从同步的时间，减少锁等待的时间

