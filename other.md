这是我的给你的日志信息：[{"eventId":"0","iTraceId":"","module":"CONFIG_API_GZ_3","requestPkg":"{\"action\":\"DescribeConfigRule\",\"region\":\"\",\"token\":\"\",\"version\":\"\",\"requestId\":\"20250527153639-39rsEggWsqhuwmQ7E551p\",\"appId\":\"0\",\"uin\":\"100019718816\",\"subAccountUin\":\"\",\"clientIp\":\"\",\"camContext\":\"\",\"ruleId\":\"cr-66jqHZInKjYVhS6arKVP\"}","__TAG__":{"pod_label_cloud-tencent-com/instance-type":"S4.2XLARGE16","pod_label_qcloud-app":"config-api-gz-3","pod_label_tkex-workload-kind":"statefulsetplus","pod_label_controller-revision-hash":"config-api-gz-3-859c446df7","pod_label_cloud-tencent-com/asset-code":"","pod_label_k8s-app":"config-api-gz-3","pod_uid":"3ac19cdd-20e0-492f-b4f1-2160b51365b8","pod_ip":"30.49.184.19","pod_label_clusterId":"cls-4g9b5b18","pod_label_tkex-workload-name":"config-api-gz-3","pod_name":"config-api-gz-3-2","pod_label_tkex-projectName":"prj7849s","image_name":"csighub.tencentyun.com/tencent-cloud-platform/config_api:release_zefinnhao_20250410_173839","cluster_id":"cls-4g9b5b18","pod_label_env":"production","container_name":"config-api-gz-3","pod_label_cloud-tencent-com/pool":"qcloud","pod_label_moduleFourId":"2897822","namespace":"ns-prj7849s-2897822-production","pod_label_statefulsetplus-kubernetes-io/pod-name":"config-api-gz-3-2","pod_label_region":"ap-guangzhou","pod_label_workload-kind":"statefulsetplus","pod_label_projectName":"prj7849s"},"returnCode":"0","caller":"config_rule_engine","returnMsg":"ok","responsePkg":"","unixtimestamp":"1748331399","serverAddr":"30.49.184.19","service":"config_api","clientIp":"30.167.66.50","action":"/DescribeConfigRule","uin":"","timeCost":"27254","reporterType":"0"},{"eventId":"0","iTraceId":"","module":"CONFIG_API_GZ_4","requestPkg":"{\"action\":\"DescribeConfigRule\",\"region\":\"\",\"token\":\"\",\"version\":\"\",\"requestId\":\"20250527153639-hMjCRl4QJecdTq6tZzr6p\",\"appId\":\"0\",\"uin\":\"100019718816\",\"subAccountUin\":\"\",\"clientIp\":\"\",\"camContext\":\"\",\"ruleId\":\"cr-66jqHZInKjYVhS6arKVP\"}","__TAG__":{"pod_label_cloud-tencent-com/instance-type":"SA2.2XLARGE16","pod_label_qcloud-app":"config-api-gz-4","pod_label_tkex-workload-kind":"statefulsetplus","pod_label_controller-revision-hash":"config-api-gz-4-6d58646fb7","pod_label_cloud-tencent-com/asset-code":"","pod_label_k8s-app":"config-api-gz-4","pod_uid":"98398a7d-bc03-4a44-9c10-3ebed2d73fa4","pod_ip":"21.10.174.2","pod_label_clusterId":"cls-pm40lmeq","pod_label_tkex-workload-name":"config-api-gz-4","pod_name":"config-api-gz-4-2","pod_label_tkex-projectName":"prj7849s","image_name":"csighub.tencentyun.com/tencent-cloud-platform/config_api:release_zefinnhao_20250410_173839","cluster_id":"cls-pm40lmeq","pod_label_env":"production","container_name":"config-api-gz-4","pod_label_cloud-tencent-com/pool":"qcloud","pod_label_moduleFourId":"2897822","namespace":"ns-prj7849s-2897822-production","pod_label_statefulsetplus-kubernetes-io/pod-name":"config-api-gz-4-2","pod_label_region":"ap-guangzhou","pod_label_workload-kind":"statefulsetplus","pod_label_projectName":"prj7849s"},"returnCode":"0","caller":"config_rule_engine","returnMsg":"ok","responsePkg":"","unixtimestamp":"1748331399","serverAddr":"21.10.174.2","service":"config_api","clientIp":"30.167.66.50","action":"/DescribeConfigRule","uin":"","timeCost":"6292","reporterType":"0"},{"eventId":"0","iTraceId":"","module":"CONFIG_API_GZ_3","requestPkg":"{\"action\":\"DescribeConfigRule\",\"region\":\"\",\"token\":\"\",\"version\":\"\",\"requestId\":\"20250527153638-STjKSMLDdFjVFOPzLEhFy\",\"appId\":\"0\",\"uin\":\"100019718816\",\"subAccountUin\":\"\",\"clientIp\":\"\",\"camContext\":\"\",\"ruleId\":\"cr-66jqHZInKjYVhS6arKVP\"}","__TAG__":{"pod_label_cloud-tencent-com/instance-type":"S3.2XLARGE16","pod_label_qcloud-app":"config-api-gz-3","pod_label_tkex-workload-kind":"statefulsetplus","pod_label_controller-revision-hash":"config-api-gz-3-859c446df7","pod_label_cloud-tencent-com/asset-code":"","pod_label_k8s-app":"config-api-gz-3","pod_uid":"d5732f41-9747-4821-8b93-4194a20a1c98","pod_ip":"30.45.9.108","pod_label_clusterId":"cls-4g9b5b18","pod_label_tkex-workload-name":"config-api-gz-3","pod_name":"config-api-gz-3-3","pod_label_tkex-projectName":"prj7849s","image_name":"csighub.tencentyun.com/tencent-cloud-platform/config_api:release_zefinnhao_20250410_173839","cluster_id":"cls-4g9b5b18","pod_label_env":"production","container_name":"config-api-gz-3","pod_label_cloud-tencent-com/pool":"qcloud","pod_label_moduleFourId":"2897822","namespace":"ns-prj7849s-2897822-production","pod_label_statefulsetplus-kubernetes-io/pod-name":"config-api-gz-3-3","pod_label_region":"ap-guangzhou","pod_label_workload-kind":"statefulsetplus","pod_label_projectName":"prj7849s"},"returnCode":"0","caller":"config_rule_engine","returnMsg":"ok","responsePkg":"","unixtimestamp":"1748331398","serverAddr":"30.45.9.108","service":"config_api","clientIp":"30.167.66.50","action":"/DescribeConfigRule","uin":"","timeCost":"25388","reporterType":"0"},{"eventId":"0","iTraceId":"","module":"CONFIG_API_GZ_3","requestPkg":"{\"action\":\"DescribeConfigRule\",\"region\":\"\",\"token\":\"\",\"version\":\"\",\"requestId\":\"20250527153638-LWkfH3CRdy4EYTzjSar8t\",\"appId\":\"0\",\"uin\":\"100019718816\",\"subAccountUin\":\"\",\"clientIp\":\"\",\"camContext\":\"\",\"ruleId\":\"cr-66jqHZInKjYVhS6arKVP\"}","__TAG__":{"pod_label_cloud-tencent-com/instance-type":"S3.2XLARGE16","pod_label_qcloud-app":"config-api-gz-3","pod_label_tkex-workload-kind":"statefulsetplus","pod_label_controller-revision-hash":"config-api-gz-3-859c446df7","pod_label_cloud-tencent-com/asset-code":"","pod_label_k8s-app":"config-api-gz-3","pod_uid":"d5732f41-9747-4821-8b93-4194a20a1c98","pod_ip":"30.45.9.108","pod_label_clusterId":"cls-4g9b5b18","pod_label_tkex-workload-name":"config-api-gz-3","pod_name":"config-api-gz-3-3","pod_label_tkex-projectName":"prj7849s","image_name":"csighub.tencentyun.com/tencent-cloud-platform/config_api:release_zefinnhao_20250410_173839","cluster_id":"cls-4g9b5b18","pod_label_env":"production","container_name":"config-api-gz-3","pod_label_cloud-tencent-com/pool":"qcloud","pod_label_moduleFourId":"2897822","namespace":"ns-prj7849s-2897822-production","pod_label_statefulsetplus-kubernetes-io/pod-name":"config-api-gz-3-3","pod_label_region":"ap-guangzhou","pod_label_workload-kind":"statefulsetplus","pod_label_projectName":"prj7849s"},"returnCode":"0","caller":"config_rule_engine","returnMsg":"ok","responsePkg":"","unixtimestamp":"1748331398","serverAddr":"30.45.9.108","service":"config_api","clientIp":"30.167.66.50","action":"/DescribeConfigRule","uin":"","timeCost":"26855","reporterType":"0"},{"eventId":"0","iTraceId":"","module":"CONFIG_API_GZ_3","requestPkg":"{\"action\":\"DescribeConfigRule\",\"region\":\"\",\"token\":\"\",\"version\":\"\",\"requestId\":\"20250527153638-8YLsV9psS7c2V4ETgm0pO\",\"appId\":\"0\",\"uin\":\"100019718816\",\"subAccountUin\":\"\",\"clientIp\":\"\",\"camContext\":\"\",\"ruleId\":\"cr-wELDMsHCKuX21LgzMT7X\"}","__TAG__":{"pod_label_cloud-tencent-com/instance-type":"S3.2XLARGE16","pod_label_qcloud-app":"config-api-gz-3","pod_label_tkex-workload-kind":"statefulsetplus","pod_label_controller-revision-hash":"config-api-gz-3-859c446df7","pod_label_cloud-tencent-com/asset-code":"","pod_label_k8s-app":"config-api-gz-3","pod_uid":"d5732f41-9747-4821-8b93-4194a20a1c98","pod_ip":"30.45.9.108","pod_label_clusterId":"cls-4g9b5b18","pod_label_tkex-workload-name":"config-api-gz-3","pod_name":"config-api-gz-3-3","pod_label_tkex-projectName":"prj7849s","image_name":"csighub.tencentyun.com/tencent-cloud-platform/config_api:release_zefinnhao_20250410_173839","cluster_id":"cls-4g9b5b18","pod_label_env":"production","container_name":"config-api-gz-3","pod_label_cloud-tencent-com/pool":"qcloud","pod_label_moduleFourId":"2897822","namespace":"ns-prj7849s-2897822-production","pod_label_statefulsetplus-kubernetes-io/pod-name":"config-api-gz-3-3","pod_label_region":"ap-guangzhou","pod_label_workload-kind":"statefulsetplus","pod_label_projectName":"prj7849s"},"returnCode":"0","caller":"config_rule_engine","returnMsg":"ok","responsePkg":"","unixtimestamp":"1748331398","serverAddr":"30.45.9.108","service":"config_api","clientIp":"30.167.66.50","action":"/DescribeConfigRule","uin":"","timeCost":"22491","reporterType":"0"},{"eventId":"0","iTraceId":"","module":"CONFIG_API_GZ_3","requestPkg":"{\"action\":\"DescribeConfigRule\",\"region\":\"\",\"token\":\"\",\"version\":\"\",\"requestId\":\"20250527153638-6djBeXqQe3950bjyGwMu0\",\"appId\":\"0\",\"uin\":\"100019718816\",\"subAccountUin\":\"\",\"clientIp\":\"\",\"camContext\":\"\",\"ruleId\":\"cr-wELDMsHCKuX21LgzMT7X\"}","__TAG__":{"pod_label_cloud-tencent-com/instance-type":"S3.2XLARGE16","pod_label_qcloud-app":"config-api-gz-3","pod_label_tkex-workload-kind":"statefulsetplus","pod_label_controller-revision-hash":"config-api-gz-3-859c446df7","pod_label_cloud-tencent-com/asset-code":"","pod_label_k8s-app":"config-api-gz-3","pod_uid":"d5732f41-9747-4821-8b93-4194a20a1c98","pod_ip":"30.45.9.108","pod_label_clusterId":"cls-4g9b5b18","pod_label_tkex-workload-name":"config-api-gz-3","pod_name":"config-api-gz-3-3","pod_label_tkex-projectName":"prj7849s","image_name":"csighub.tencentyun.com/tencent-cloud-platform/config_api:release_zefinnhao_20250410_173839","cluster_id":"cls-4g9b5b18","pod_label_env":"production","container_name":"config-api-gz-3","pod_label_cloud-tencent-com/pool":"qcloud","pod_label_moduleFourId":"2897822","namespace":"ns-prj7849s-2897822-production","pod_label_statefulsetplus-kubernetes-io/pod-name":"config-api-gz-3-3","pod_label_region":"ap-guangzhou","pod_label_workload-kind":"statefulsetplus","pod_label_projectName":"prj7849s"},"returnCode":"0","caller":"config_rule_engine","returnMsg":"ok","responsePkg":"","unixtimestamp":"1748331398","serverAddr":"30.45.9.108","service":"config_api","clientIp":"30.167.66.50","action":"/DescribeConfigRule","uin":"","timeCost":"19566","reporterType":"0"},{"eventId":"0","iTraceId":"","module":"CONFIG_API_GZ_3","requestPkg":"{\"action\":\"DescribeConfigRule\",\"region\":\"\",\"token\":\"\",\"version\":\"\",\"requestId\":\"20250527153638-3yyvAN5PXDD6AeJmqo5tN\",\"appId\":\"0\",\"uin\":\"100019718816\",\"subAccountUin\":\"\",\"clientIp\":\"\",\"camContext\":\"\",\"ruleId\":\"cr-66jqHZInKjYVhS6arKVP\"}","__TAG__":{"pod_label_cloud-tencent-com/instance-type":"S3.2XLARGE16","pod_label_qcloud-app":"config-api-gz-3","pod_label_tkex-workload-kind":"statefulsetplus","pod_label_controller-revision-hash":"config-api-gz-3-859c446df7","pod_label_cloud-tencent-com/asset-code":"","pod_label_k8s-app":"config-api-gz-3","pod_uid":"89e5ced1-9386-4ae9-b850-d452245bf7cb","pod_ip":"30.49.108.27","pod_label_clusterId":"cls-4g9b5b18","pod_label_tkex-workload-name":"config-api-gz-3","pod_name":"config-api-gz-3-1","pod_label_tkex-projectName":"prj7849s","image_name":"csighub.tencentyun.com/tencent-cloud-platform/config_api:release_zefinnhao_20250410_173839","cluster_id":"cls-4g9b5b18","pod_label_env":"production","container_name":"config-api-gz-3","pod_label_cloud-tencent-com/pool":"qcloud_ziyan_eks","pod_label_moduleFourId":"2897822","namespace":"ns-prj7849s-2897822-production","pod_label_statefulsetplus-kubernetes-io/pod-name":"config-api-gz-3-1","pod_label_region":"ap-guangzhou","pod_label_workload-kind":"statefulsetplus","pod_label_projectName":"prj7849s"},"returnCode":"0","caller":"config_rule_engine","returnMsg":"ok","responsePkg":"","unixtimestamp":"1748331398","serverAddr":"30.49.108.27","service":"config_api","clientIp":"30.167.66.50","action":"/DescribeConfigRule","uin":"","timeCost":"27926","reporterType":"0"},{"eventId":"0","iTraceId":"","module":"CONFIG_API_GZ_4","requestPkg":"{\"action\":\"DescribeConfigRule\",\"region\":\"\",\"token\":\"\",\"version\":\"\",\"requestId\":\"20250527153638-5zYS4r9C0KVVUKWwPfaHI\",\"appId\":\"0\",\"uin\":\"100019718816\",\"subAccountUin\":\"\",\"clientIp\":\"\",\"camContext\":\"\",\"ruleId\":\"cr-66jqHZInKjYVhS6arKVP\"}","__TAG__":{"pod_label_cloud-tencent-com/instance-type":"SA2.2XLARGE16","pod_label_qcloud-app":"config-api-gz-4","pod_label_tkex-workload-kind":"statefulsetplus","pod_label_controller-revision-hash":"config-api-gz-4-6d58646fb7","pod_label_cloud-tencent-com/asset-code":"","pod_label_k8s-app":"config-api-gz-4","pod_uid":"08edb96b-1b38-4d31-b781-d11d2e8ea074","pod_ip":"21.18.97.109","pod_label_clusterId":"cls-pm40lmeq","pod_label_tkex-workload-name":"config-api-gz-4","pod_name":"config-api-gz-4-3","pod_label_tkex-projectName":"prj7849s","image_name":"csighub.tencentyun.com/tencent-cloud-platform/config_api:release_zefinnhao_20250410_173839","cluster_id":"cls-pm40lmeq","pod_label_env":"production","container_name":"config-api-gz-4","pod_label_cloud-tencent-com/pool":"qcloud","pod_label_moduleFourId":"2897822","namespace":"ns-prj7849s-2897822-production","pod_label_statefulsetplus-kubernetes-io/pod-name":"config-api-gz-4-3","pod_label_region":"ap-guangzhou","pod_label_workload-kind":"statefulsetplus","pod_label_projectName":"prj7849s"},"returnCode":"0","caller":"config_rule_engine","returnMsg":"ok","responsePkg":"","unixtimestamp":"1748331398","serverAddr":"21.18.97.109","service":"config_api","clientIp":"30.167.66.50","action":"/DescribeConfigRule","uin":"","timeCost":"6006","reporterType":"0"},{"eventId":"0","iTraceId":"","module":"CONFIG_API_GZ_3","requestPkg":"{\"action\":\"DescribeConfigRule\",\"region\":\"\",\"token\":\"\",\"version\":\"\",\"requestId\":\"20250527153638-UJwGzNm19F9fIE9NFUM1a\",\"appId\":\"0\",\"uin\":\"100019718816\",\"subAccountUin\":\"\",\"clientIp\":\"\",\"camContext\":\"\",\"ruleId\":\"cr-66jqHZInKjYVhS6arKVP\"}","__TAG__":{"pod_label_cloud-tencent-com/instance-type":"S3.2XLARGE16","pod_label_qcloud-app":"config-api-gz-3","pod_label_tkex-workload-kind":"statefulsetplus","pod_label_controller-revision-hash":"config-api-gz-3-859c446df7","pod_label_cloud-tencent-com/asset-code":"","pod_label_k8s-app":"config-api-gz-3","pod_uid":"51529128-a708-459b-b7c4-4ccf079c328b","pod_ip":"9.148.247.252","pod_label_clusterId":"cls-4g9b5b18","pod_label_tkex-workload-name":"config-api-gz-3","pod_name":"config-api-gz-3-0","pod_label_tkex-projectName":"prj7849s","image_name":"csighub.tencentyun.com/tencent-cloud-platform/config_api:release_zefinnhao_20250410_173839","cluster_id":"cls-4g9b5b18","pod_label_env":"production","container_name":"config-api-gz-3","pod_label_cloud-tencent-com/pool":"qcloud_ziyan_eks","pod_label_moduleFourId":"2897822","namespace":"ns-prj7849s-2897822-production","pod_label_statefulsetplus-kubernetes-io/pod-name":"config-api-gz-3-0","pod_label_region":"ap-guangzhou","pod_label_workload-kind":"statefulsetplus","pod_label_projectName":"prj7849s"},"returnCode":"0","caller":"config_rule_engine","returnMsg":"ok","responsePkg":"","unixtimestamp":"1748331398","serverAddr":"9.148.247.252","service":"config_api","clientIp":"30.167.66.50","action":"/DescribeConfigRule","uin":"","timeCost":"26431","reporterType":"0"},{"eventId":"0","iTraceId":"","module":"CONFIG_API_GZ_3","requestPkg":"{\"action\":\"DescribeConfigRule\",\"region\":\"\",\"token\":\"\",\"version\":\"\",\"requestId\":\"20250527153638-hX5GdA1MEhwVBOUH3ZM2k\",\"appId\":\"0\",\"uin\":\"100019718816\",\"subAccountUin\":\"\",\"clientIp\":\"\",\"camContext\":\"\",\"ruleId\":\"cr-66jqHZInKjYVhS6arKVP\"}","__TAG__":{"pod_label_cloud-tencent-com/instance-type":"S3.2XLARGE16","pod_label_qcloud-app":"config-api-gz-3","pod_label_tkex-workload-kind":"statefulsetplus","pod_label_controller-revision-hash":"config-api-gz-3-859c446df7","pod_label_cloud-tencent-com/asset-code":"","pod_label_k8s-app":"config-api-gz-3","pod_uid":"51529128-a708-459b-b7c4-4ccf079c328b","pod_ip":"9.148.247.252","pod_label_clusterId":"cls-4g9b5b18","pod_label_tkex-workload-name":"config-api-gz-3","pod_name":"config-api-gz-3-0","pod_label_tkex-projectName":"prj7849s","image_name":"csighub.tencentyun.com/tencent-cloud-platform/config_api:release_zefinnhao_20250410_173839","cluster_id":"cls-4g9b5b18","pod_label_env":"production","container_name":"config-api-gz-3","pod_label_cloud-tencent-com/pool":"qcloud_ziyan_eks","pod_label_moduleFourId":"2897822","namespace":"ns-prj7849s-2897822-production","pod_label_statefulsetplus-kubernetes-io/pod-name":"config-api-gz-3-0","pod_label_region":"ap-guangzhou","pod_label_workload-kind":"statefulsetplus","pod_label_projectName":"prj7849s"},"returnCode":"0","caller":"config_rule_engine","returnMsg":"ok","responsePkg":"","unixtimestamp":"1748331398","serverAddr":"9.148.247.252","service":"config_api","clientIp":"30.167.66.50","action":"/DescribeConfigRule","uin":"","timeCost":"27679","reporterType":"0"}]


curl 'https://simqry2.eastmoney.com/qry_tzzh_v2?type=spo_rank_syl&plat=2&ver=web20&utToken=&ctToken=&sylType=10001&recIdx=1&recCnt=250&cb=jQuery112304628108748133831_1748348052065&_=1748348052066' \
  -H 'Accept: */*' \
  -H 'Accept-Language: zh-CN,zh;q=0.9,en;q=0.8' \
  -H 'Connection: keep-alive' \
  -b 'qgqp_b_id=c1b5f818e1b7bb024cbe5457f6f1ea69; st_si=08770639335019; HAList=ty-0-300255-%u5E38%u5C71%u836F%u4E1A; fullscreengg=1; fullscreengg2=1; st_pvi=05347401450250; st_sp=2025-05-27%2019%3A36%3A52; st_inirUrl=https%3A%2F%2Fquote.eastmoney.com%2Fredirect.html; st_sn=1; st_psi=20250527193651805-113200301201-1505707756; st_asi=delete' \
  -H 'Referer: https://group.eastmoney.com/mcombin,10001.html' \
  -H 'Sec-Fetch-Dest: script' \
  -H 'Sec-Fetch-Mode: no-cors' \
  -H 'Sec-Fetch-Site: same-site' \
  -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36' \
  -H 'sec-ch-ua: "Chromium";v="136", "Google Chrome";v="136", "Not.A/Brand";v="99"' \
  -H 'sec-ch-ua-mobile: ?0' \
  -H 'sec-ch-ua-platform: "macOS"'

-- 全量三表关联
SELECT 
    d.service AS 接口服务,
    d.action AS 接口名,
    JSON_ARRAYAGG(
        JSON_OBJECT(
            'name', p.para_name,
            'type', p.param_type,
            'description', IFNULL(p.description, ''),
            'example', IFNULL(p.example_value, ''),
            'is_sensitive', p.is_sensitive
        )
    ) AS 接口参数,
    d.interface_desc AS 接口描述
FROM 
    api_interface_doc_distinct d
LEFT JOIN 
    api_response_params p ON d.id = p.interface_id
GROUP BY 
    d.id, d.service, d.action, d.interface_desc
ORDER BY 
    d.action asc
LIMIT 0, 500;

SELECT 
    d.service AS 接口服务,
    d.action AS 接口名,
    JSON_ARRAYAGG(
        JSON_OBJECT(
            'name', p.para_name,
            'type', p.param_type,
            'description', IFNULL(p.description, ''),
            'example', IFNULL(p.example_value, ''),
            'is_sensitive', p.is_sensitive
        )
    ) AS 接口参数,
    d.interface_desc AS 接口描述
FROM 
    api_interface_doc_distinct d
LEFT JOIN 
    api_response_params p ON d.id = p.interface_id
GROUP BY 
    d.id, d.service, d.action, d.interface_desc
ORDER BY 
    d.action asc
LIMIT 500, 500;

SELECT 
    d.service AS 接口服务,
    d.action AS 接口名,
    JSON_ARRAYAGG(
        JSON_OBJECT(
            'name', p.para_name,
            'type', p.param_type,
            'description', IFNULL(p.description, ''),
            'example', IFNULL(p.example_value, ''),
            'is_sensitive', p.is_sensitive
        )
    ) AS 接口参数,
    d.interface_desc AS 接口描述
FROM 
    api_interface_doc_distinct d
LEFT JOIN 
    api_response_params p ON d.id = p.interface_id
GROUP BY 
    d.id, d.service, d.action, d.interface_desc
ORDER BY 
    d.action asc
LIMIT 1000, 500;

SELECT 
    d.service AS 接口服务,
    d.action AS 接口名,
    JSON_ARRAYAGG(
        JSON_OBJECT(
            'name', p.para_name,
            'type', p.param_type,
            'description', IFNULL(p.description, ''),
            'example', IFNULL(p.example_value, ''),
            'is_sensitive', p.is_sensitive
        )
    ) AS 接口参数,
    d.interface_desc AS 接口描述
FROM 
    api_interface_doc_distinct d
LEFT JOIN 
    api_response_params p ON d.id = p.interface_id
GROUP BY 
    d.id, d.service, d.action, d.interface_desc
ORDER BY 
    d.action asc
LIMIT 1500, 500;

-- 敏感三表关联
SELECT 
    d.service AS 接口服务,
    d.action AS 接口名,
    JSON_ARRAYAGG(
        JSON_OBJECT(
            'name', p.para_name,
            'type', p.param_type,
            'description', IFNULL(p.description, ''),
            'example', IFNULL(p.example_value, ''),
            'is_sensitive', p.is_sensitive
        )
    ) AS 接口参数,
    d.interface_desc AS 接口描述,
    r.reason AS 敏感原因,
    r.sensitive_type AS 敏感类型,
    r.related_tables AS 关联表,
    r.confirmed AS 是否已确认
FROM 
    api_interface_doc_distinct d
INNER JOIN 
    interface_risk_sensitive_doc_v2 r ON d.action = r.interface
LEFT JOIN 
    api_response_params p ON d.id = p.interface_id
WHERE 
    r.is_sensitive = 1
GROUP BY 
    d.id, d.service, d.action, d.interface_desc,
    r.reason, r.sensitive_type, r.related_tables, r.confirmed
ORDER BY 
    r.confirmed ASC, d.id DESC
LIMIT 0,500;

SELECT 
    d.service AS 接口服务,
    d.action AS 接口名,
    JSON_ARRAYAGG(
        JSON_OBJECT(
            'name', p.para_name,
            'type', p.param_type,
            'description', IFNULL(p.description, ''),
            'example', IFNULL(p.example_value, ''),
            'is_sensitive', p.is_sensitive
        )
    ) AS 接口参数,
    d.interface_desc AS 接口描述,
    r.reason AS 敏感原因,
    r.sensitive_type AS 敏感类型,
    r.related_tables AS 关联表,
    r.confirmed AS 是否已确认
FROM 
    api_interface_doc_distinct d
INNER JOIN 
    interface_risk_sensitive_doc_v2 r ON d.action = r.interface
LEFT JOIN 
    api_response_params p ON d.id = p.interface_id
WHERE 
    r.is_sensitive = 1
GROUP BY 
    d.id, d.service, d.action, d.interface_desc,
    r.reason, r.sensitive_type, r.related_tables, r.confirmed
ORDER BY 
    r.confirmed ASC, d.id DESC
LIMIT 500,500;

-- 高危三表关联
SELECT 
    d.service AS 接口服务,
    d.action AS 接口名,
    JSON_ARRAYAGG(
        JSON_OBJECT(
            'name', p.para_name,
            'type', p.param_type,
            'description', IFNULL(p.description, ''),
            'is_sensitive', p.is_sensitive
        )
    ) AS 接口参数,
    d.interface_desc AS 接口描述,
    r.reason AS 高危原因,
    r.risk_type AS 高危类型,
    r.related_tables AS 关联表
FROM 
    api_interface_doc_distinct d
LEFT JOIN 
    api_response_params p ON d.id = p.interface_id
JOIN 
    interface_risk_sensitive_doc_v2 r ON d.action = r.interface
WHERE 
    r.is_high_risk = 1
GROUP BY 
    d.id, d.service, d.action, d.interface_desc,
    r.reason, r.risk_type, r.related_tables
LIMIT 500;





----- 


SELECT
    COUNT(1) AS total,
    SUM(CASE WHEN is_high_risk = 1 THEN 1 ELSE 0 END) AS risk_count,
    COUNT(1) - SUM(CASE WHEN is_high_risk = 1 THEN 1 ELSE 0 END) AS risk_difference,
    SUM(CASE WHEN is_sensitive = 1 THEN 1 ELSE 0 END) AS sensitive_count,
    COUNT(1) - SUM(CASE WHEN is_sensitive = 1 THEN 1 ELSE 0 END) AS sensitive_difference
FROM interface_risk_sensitive_doc_v2 LIMIT 1;

SELECT COUNT(1) from interface_risk_sensitive_doc_distinct where is_high_risk = 1 LIMIT 1;

SELECT * from interface_risk_sensitive_doc_v2 where is_sensitive = 1 order by create_time limit 250;

SELECT * from interface_risk_sensitive_doc_v2 where is_high_risk = 1 ORDER BY create_time desc LIMIT 200 ;

some ques:
1. 接口表，根据condition筛选出符合的接口
  - 接口表去哪里获得
  - condition规则
    - 
2. 去TDW拿这些接口的日志，需要的字段有clientIp，requestPkg，interfaceName
3. 每个记录十条，写入数据库
4. 导出一份excel文档

SELECT uin,
       cientip,
       product,
       interface,
       code,
       timecost,
       get_json_object(response, '$.data.ownerUin') AS owinerUin,
       get_json_object(request, '$.interface.para.auth_token') AS auth_token,
       request,
       response,
       token,
       from_unixtime(logtime) as log_at
FROM csig_cam::sig_auth_comm_log
WHERE
    tdbank_imp_date = '${YYYYMMDDHH}'
  AND get_json_object(request, '$.interface.interfaceName') = 'logic.cam.checkResource'
  AND get_json_object(response, '$.data.ownerUin') = '1977869558' 
  AND get_json_object(concat('{\"arr\":', token, '}'), '$.arr[0].hasPolicyFilter') = 1
  AND (get_json_object(get_json_object(CONCAT('{\"arr\":', token, '}'), '$.arr[0].extraInfo'), '$.tokenType') is NULL
   or get_json_object(get_json_object(CONCAT('{\"arr\":', token, '}'), '$.arr[0].extraInfo'), '$.tokenType') != 9)
  AND (get_json_object(get_json_object(CONCAT('{\"arr\":', token, '}'), '$.arr[0].extraInfo'), '$.thOwnerUin') is NULL
   OR get_json_object(get_json_object(CONCAT('{\"arr\":', token, '}'), '$.arr[0].extraInfo'), '$.thOwnerUin') = '')



1. 修改Prompt，跑接口分类分级的文档数据
2. 修改cam_diff服务，增加北极星接入和多地址转发和某些字段的匹配逻辑，完善脚本
3. cam_diff服务增加一个udp_client，负责在开启时候从五分钟前开始读从cls读日志打成udp包发到cam_diff

CREATE DATASOURCE `interface_doc_db` WITH (
datasource=jdbc, 
url=`jdbc:supersql:datasource:url='jdbc:mysql://30.46.139.169:3306/interface_doc_db?characterEncoding=utf8&connectTimeout=30000';driver='com.mysql.jdbc.Driver';jarPath='./supersql-drivers.zip/mysql'`,
driver=`com.tencent.supersql.connector.SuperSqlDataSourceDriver`,
username=conf, 
password=`2j5O62RRV5aIeGLp`,
catalog=interface_doc_db,
type=mysql)




请用python。现在是这样，我希望从数据库表tdw_record中查询出数据是否大于10（根据product和interface），如果小于10，那么就拿product和interface去数仓查数据，然后插入到表中。
这是mysql数据库tdw_record的建表sql：
CREATE TABLE `tdw_record` (
                            `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID',
                            `uin` bigint DEFAULT NULL COMMENT '用户ID',
                            `client_ip` varchar(50) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '客户IP',
                            `product` varchar(255) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '产品',
                            `interface` varchar(255) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '接口',
                            `request` text COLLATE utf8mb4_unicode_ci COMMENT '请求数据',
                            `response` text COLLATE utf8mb4_unicode_ci COMMENT '响应数据',
                            `tdbank_impl_date` varchar(20) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '导入日期',
                            `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
                            `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
                            PRIMARY KEY (`id`),
                            KEY `idx_tdbank_impl_date` (`tdbank_impl_date`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='tdw记录表';
，代码我已经写了一些，可以给你参考：
def TDW_PL(tdw, argv):
    for product, interface in fetch_interface_list():
        sql = """
            select uin, cientip, product, interface, request, response, mode
            from csig_cam::sig_auth_comm_log
            where tdbank_imp_date > '2025050110' 
              and tdbank_imp_date < '20250503018'
              and product = '%s'
              and interface = '%s'
            limit 10
        """
        sql = sql % (product, interface)
        tdw.WriteLog(sql)
        res = tdw.execute(sql)
        tdw.WriteLog(res)

def select_interface(product, interface):
    sql = """
        select count(1) from interface_doc_db.`tdw_record` where product = '%s' and interface = '%s'
    """
     # sql = sql % (product, interface)
    res = tdw.execute(sql)
    tdw.WriteLog(res)

def fetch_interface_list():
    non_cloud_apis = """
        cvm:ResetInstances
        cvm:CheckSecurityGroupPolicyRedundancy
        cvm:DescribeInstancesOfferingsV3
        cvm:DescribeInstanceTypeQuotaV3
        cvm:DescribeZonesV3
        cvm:InquiryInstancePriceHour
        cvm:InquiryPriceAllocateHostsV3
        cvm:DescribeInstanceMainInfo
        cvm:DescribeInstanceStatisticsV3
        cvm:DescribeKeyPairsV3
        cvm:InquiryInstanceBandwidthConfig
        cvm:InquiryInstanceOrOSConfig
        cvm:InquiryPriceResetInstancesTypeV3
        cvm:DescribeDiskConfigQuota
        cvm:DescribeDiskFeatures
        cvm:DescribeDiskInitializationUserData
        cvm:DescribeDisksDeniedActions
        cvm:DescribeSnapshotGroupsDeniedActions
        cvm:DescribeSnapshotsDeniedActions
        cvm:GetSnapOverview
        cvm:DescribeInstanceTypeSalesConfig
        cvm:InquirePriceModifyDiskBackupQuota
        cvm:InquirePriceModifyDiskExtraPerformance
        cvm:InquirePriceRefundDisks
        cvm:InquiryPriceCreateDisks
        cvm:InquiryPriceModifyDiskAttributes
        cvm:InquiryPriceModifyDisksChargeType
        cvm:InquiryPriceRenewDisks
        cvm:InquiryPriceResizeDisk
        cvm:ModifyInstanceFamiliesAttribute
        cvm:SwitchParameterCreateDisks
        cvm:SwitchParameterModifyDiskAttributes
        cvm:SwitchParameterModifyDiskChargeType
        cvm:SwitchParameterModifyDiskExtraPerformance
        cvm:SwitchParameterRenewDisks
        cvm:SwitchParameterResizeDisk
        cvm:DescribeCbsOperationLogs
        cvm:ModifyInstanceTypeSalesConfig
        cvm:ModifyDiskRollbackType
    """

    cloud_apis = """
        cvm:DescribeInstanceBanInfo
        cvm:DescribeAddresses
        cvm:ReleaseAddresses
        cvm:AssociateAddress
        cvm:DisassociateAddress
        cvm:RenewAddresses
        cvm:ModifyAddressesBandwidth
        cvm:StopInstances
        cvm:TerminateInstances
        cvm:DescribeInstances
        cvm:DescribeInstancesStatus
        cvm:ResetInstance
        cvm:DescribeImages
        cvm:AllocateAddresses
    """

    return parse_apis(non_cloud_apis) + parse_apis(cloud_apis)


def parse_apis(api_string):
    """Parse API string and return formatted list of (product, interface) tuples"""
    apis = []
    for line in api_string.strip().split('\n'):
        line = line.strip()
        if line:
            product, interface = line.split(':')
            apis.append((product.strip(), interface.strip()))  # Using tuple instead of list
    return apis
我告诉你，tdw的返回数据格式是tsv的，比如我查询select count(1) from interface_doc_db.`tdw_record` where product = '%s' and interface = '%s'
这是res的打印结果：['1\t2710703044\t21.7.221.99\tcvm\tDescribeAddresses\t{"version":0,"eventId":1748563162,"timestamp":1748563162,"interface":{"interfaceName":"logic.cam.sigAndAuth","para":{"mode":2,"new_check_resource":1,"resource":"qcs::cvm:bj:uin\\/2710703044:eip\\/*","ownerUin":"2710703044","sub_condition":[],"uin":"2710703044","action":"cvm:DescribeAddresses"}}}\t{"version":"0","componentName":"mall_logic","timestamp":"0","eventId":1748563162,"returnValue":0,"returnCode":0,"returnMessage":"permission verify","data":{"ownerUin":2710703044,"uin":2710703044,"ownerAppid":0,"ownerUinStr":"2710703044","uinStr":"2710703044","ownerAppidStr":"0","keyType":0,"keySource":0,"formatString":"","stringToSign":"","permissionDetail":[],"transferDetail":[],"debugInfo":[],"accountArea":0}}\tNULL\t2025-05-30 18:33:53\t2025-05-30 18:33:53']，请你完成我的需求

使用AI写代码，我会先看需求是否复杂：
1. 简单的，只说重要的信息：比如用什么语言写，要做到什么，要求输出一个function然后修改
2. 略微复杂的，一般会新建一个Prompt文件，在内部给出输入输出和简单介绍需求，然后给AI处理，比如


「风险SQL治理&SQL注入防护」主题沙龙
风险sql的定义：
锁执行耗时
锁等待时间风险
扫描行数风险

sql风险 = 单sql执行成本 *  并发


Sql执行成本：
- 扫描的数据量、锁资源占用
- 排序连接聚合等工作量大

优化：
1. 索引优化：无索引导致全表扫描、低效索引导致扫描了大量不需要的数据
2. sql改造：
    1. 单sql返回大量数据
    2. 单sql更新、删除了大量数据
    3. count，distinct等针对大数据量进行计数、去重、聚合
    4. 深分页

并发：
1. 云API调用
    - 云API限频
    - 内部API限频
    - 慢SQL自动限流
    - 慢SQL手工限流 
2. 内部API调用

选择度

ICP，index condition pushdown， 索引下推

大sql拆分，在业务层聚合，好处是可以减少主从同步的时间，减少锁等待的时间


--- 

我有一个热重启的服务a，然后一个脚本b，每当我的发配置的时候，配置发完就会调用脚本b，来找到cam_diff进程发送HUP信号来触发热重启，
但是现在不知道为什么看日志，热重启会触发两次：
[root@api-ty-ap-guangzhou-3-set-1-0 /data/release/cam_diff/logs]# cat app.log_202506101400.log.1614 | grep "Load config success"
2025/06/10 14:16:07 [DEBUG] Load config success
2025/06/10 14:16:07 [DEBUG] Load config success
[root@api-ty-ap-guangzhou-3-set-1-0 /data/release/cam_diff/logs]# cat app.log_202506101400.log.2559 | grep "Load config success"
[root@api-ty-ap-guangzhou-3-set-1-0 /data/release/cam_diff/logs]# cat app.log_202506101100.log.4601 | grep "Load config success"
[root@api-ty-ap-guangzhou-3-set-1-0 /data/release/cam_diff/logs]# cat app.log_202506101100.log.4559 | grep "Load config success"
2025/06/10 11:45:52 [DEBUG] Load config success
2025/06/10 11:45:52 [DEBUG] Load config success
这是我的热重启相关的脚本b：
# 获取diff进程PID
pid=$(pgrep -x cam_diff)
echo $pid
[ -n "$pid" ] && kill -HUP "$pid"

这是我的代码：
package main

import (
	"bytes"
	"context"
	"encoding/json"
	"errors"
	"fmt"
	"git.code.oa.com/tencent-cloud-platform/cam_diff/model"
	"git.code.oa.com/tencent-cloud-platform/cam_diff/util"
	"io"
	"log"
	"net/http"
	"os"
	"os/exec"
	"os/signal"
	"strconv"
	"strings"
	"sync/atomic"
	"syscall"
	"time"

	"git.code.oa.com/tencent-cloud-platform/cam_diff/component"
	"git.code.oa.com/tencent-cloud-platform/cam_diff/pb/stat"
	"git.woa.com/polaris/polaris-go/v2/api"
	pmodel "git.woa.com/polaris/polaris-go/v2/pkg/model"
	"git.woa.com/tencent-cloud-platform/pandora/server"
	"github.com/panjf2000/gnet"
	"google.golang.org/protobuf/proto"
	"gopkg.in/yaml.v2"

	"git.code.oa.com/tencent-cloud-platform/cam_diff/logger"
)

var (
	channel         = make(chan *forwardData, 10000)
	handler         = &diffEventHandler{}
	restartChan     = make(chan struct{}, 1)
	shutdownChan    = make(chan struct{})
	cancel          context.CancelFunc
	isChildProcess  = os.Getenv("HOT_RELOAD_CHILD") == "1"
	parentPID       = 0
	polarisMetaInfo *model.PolarisMetaInfo
	consumerApi     api.ConsumerAPI
	glog            *logger.Logger
)

// udpServer 定义UDP服务结构体，包含事件处理器、HTTP客户端和配置
type udpServer struct {
	*gnet.EventServer                   // 继承gnet的事件处理器
	httpClient        *http.Client      // HTTP客户端用于转发请求
	UdpConfig         *model.UdpConfig  // UDP服务配置（端口、超时等）
	RuleConfigs       *model.RuleConfig // 过滤规则配置
	LimiterManager    *component.RateLimitManager
	RuleMatcher       *component.RuleMatcher
}

type forwardData struct {
	diffBody *server.DiffBody
	rule     *model.FilterRule
}

// main 程序入口
func main() {
	log.Printf("Starting server, pid: %d\n", os.Getpid())
	if isChildProcess {
		if ppid, err := strconv.Atoi(os.Getenv("HOT_RELOAD_PARENT_PID")); err == nil {
			parentPID = ppid
			log.Printf("Running as child process, parent pid: %d", parentPID)
		}
	}

	// 加载配置
	udpConfig, ruleConfig, err := loadConfig()
	l, err := initLoggerFromConfig(ruleConfig.LogConfig)
	if err != nil {
		log.Printf("Load config error: %v", err)
		os.Exit(1)
	}
	glog = l
	defer l.Close()

	glog.Info("pid: %d, parent pid: %d", os.Getpid(), parentPID)
	glog.Debug("Load config success")
	glog.Debug("udp config: %s", getJsonString(udpConfig))
	glog.Debug("rule config: %s", getJsonString(ruleConfig))

	glog.Debug("start init polaris...")
	// 初始化北极星参数
	initPolaris()
	glog.Debug("init polaris success")

	// 初始化UDP服务实例
	var udpService = &udpServer{
		UdpConfig:   udpConfig,
		RuleConfigs: ruleConfig,
		httpClient: &http.Client{
			Transport: &http.Transport{
				MaxIdleConns:        100,
				MaxIdleConnsPerHost: 10,
				IdleConnTimeout:     30 * time.Second,
			},
			Timeout: 5 * time.Second,
		},
		LimiterManager: component.NewLimiterManager(component.TokenBucket),
		RuleMatcher:    component.NewRuleMatcher(),
	}

	// 监听配置更新
	go udpService.listenReloadConfigSignal()
	// 启动协程重放请求，限制QPS
	go udpService.consumeAndReapply()
	// 处理热重启等信号
	go handleSignals()

	// 启动gnet服务
	udpServerAddr := fmt.Sprintf("udp://:%d", udpConfig.Port)
	ctx, cancelFunc := context.WithCancel(context.Background())
	cancel = cancelFunc

	glog.Info("Starting UDP server on port %d", udpConfig.Port)
	go func() {
		err = gnet.Serve(
			udpService,
			udpServerAddr,
			gnet.WithMulticore(true),
			gnet.WithReusePort(true),
			gnet.WithReuseAddr(true),
			gnet.WithTicker(false),
		)
		if err != nil {
			glog.Info("UDP server error: %v", err)
		}
		cancel()
	}()

	glog.Info("Waiting for shutdown...")
	select {
	case <-ctx.Done():
		if err := gnet.Stop(ctx, udpServerAddr); err != nil {
			glog.Info("Failed to stop gnet: %v", err)
		}
	}
}

func initPolaris() {
	polarisMetaInfo = model.NewPolarisMetaInfo()
	cfg := api.NewConfiguration()
	if len(polarisMetaInfo.Addresses) > 0 {
		cfg.GetGlobal().GetServerConnector().SetAddresses(strings.Split(polarisMetaInfo.Addresses, ","))
	} else if len(polarisMetaInfo.JoinPoint) > 0 {
		cfg.GetGlobal().GetServerConnector().SetJoinPoint(polarisMetaInfo.JoinPoint)
	}
	a, err := api.NewConsumerAPIByConfig(cfg)
	if nil != err {
		glog.Info("Fail to create ConsumerAPI by default configuration, err is %v", err)
		os.Exit(1)
	}
	consumerApi = a
}

func handleSignals() {
	sigChan := make(chan os.Signal, 1)
	signal.Notify(sigChan, syscall.SIGINT, syscall.SIGTERM, syscall.SIGHUP)
	go func() {
		for range restartChan {
			glog.Info("Restarting server...")
			hotReload()
		}
	}()
	for s := range sigChan {
		switch s {
		case syscall.SIGINT, syscall.SIGTERM:
			glog.Info("Received shutdown signal: %v", s)
			gracefulShutdown()
			return
		case syscall.SIGHUP:
			glog.Info("Received reload signal")
			select {
			case restartChan <- struct{}{}:
			default:
				glog.Info("Restart already in progress")
			}
		}
	}
}

func gracefulShutdown() {
	glog.Info("Gracefully shutting down server...")
	close(channel)
	close(shutdownChan)
	if cancel == nil {
		glog.Info("Server shutdown by os.Exit()")
		os.Exit(1)
	}
	cancel()
}

func hotReload() {
	if isChildProcess {
		glog.Info("Hot reload in child process")
	}
	glog.Info("Starting new process for hot reload...")

	execPath, err := os.Executable()
	if err != nil {
		glog.Info("Failed to get executable path: %v", err)
		return
	}

	var args []string
	for _, arg := range os.Args[1:] {
		if !strings.HasPrefix(arg, "HOT_RELOAD_") {
			args = append(args, arg)
		}
	}

	cmd := exec.Command(execPath, args...)
	cmd.Stdout = os.Stdout
	cmd.Stderr = os.Stderr
	cmd.Env = append(os.Environ(),
		"HOT_RELOAD_CHILD=1",
		fmt.Sprintf("HOT_RELOAD_PARENT_PID=%d", os.Getpid()),
	)

	if err := cmd.Start(); err != nil {
		glog.Info("Failed to start new process: %v", err)
		return
	}

	glog.Info("Started new process with PID: %d", cmd.Process.Pid)
	gracefulShutdown()
}

func (u *udpServer) React(frame []byte, c gnet.Conn) (out []byte, action gnet.Action) {
	body, err := u.decodeLog(frame)
	if err != nil {
		glog.Info("Decode log error or unmatch, err: %s", err.Error())
		if body != nil {
			glog.Debug("pBody decoded: %s", getJsonString(body))
		} else {
			glog.Debug("body is nil")
		}
	}
	if body == nil {
		glog.Debug("frame decode body is null, skip...")
		return nil, gnet.None
	}
	glog.Debug("decode frame body: %s", getJsonString(body))
	u.filterRequestAndReapplyIfMatch(body)
	return nil, gnet.None
}

func (u *udpServer) forward(diffBody *server.DiffBody, rule *model.FilterRule) {
	requestStr := diffBody.Request
	for _, addr := range rule.Forward {
		url, err := getForwardUrl(&addr)
		glog.Debug("forward url: %s", url)
		if err != nil {
			glog.Info("Fail to get forward url error: %v", err)
			continue
		}
		req, err := http.NewRequest("POST", url, bytes.NewBufferString(requestStr))
		if err != nil {
			glog.Info("Failed to create HTTP request: %v", err)
			continue
		}
		req.Header.Set("Content-Type", "application/json")
		resp, err := u.httpClient.Do(req)
		if err != nil {
			glog.Info("Failed to forward request: %v", err)
			continue
		}

		body, err := io.ReadAll(resp.Body)
		if err != nil {
			glog.Info("Failed to read response body: %v", err)
			continue
		}
		_ = resp.Body.Close()
		newResp := string(body)
		diff(diffBody.Request, diffBody.Response, newResp, url, diffBody, &addr)
	}
}

func getForwardUrl(forwardAddr *model.ForwardAddr) (url string, err error) {
	url = forwardAddr.Addr
	if !(strings.HasPrefix(url, "http://") || strings.HasPrefix(url, "https://")) {
		url = "http://" + url
	}

	split := strings.Split(forwardAddr.L5, "/")
	namespace := split[0]
	service := split[1]
	glog.Info("Getting instance for namespace: %s, service: %s", namespace, service)

	var flowId uint64
	getOneInstanceReq := &api.GetOneInstanceRequest{}
	getOneInstanceReq.FlowID = atomic.AddUint64(&flowId, 1)
	getOneInstanceReq.Namespace = namespace
	getOneInstanceReq.Service = service
	getOneInstanceReq.LbPolicy = api.LBPolicyWeightedRandom
	startTime := time.Now()

	getInstResp, err := consumerApi.GetOneInstance(getOneInstanceReq)
	if err != nil {
		glog.Info("Fail to sync GetOneInstance, use default url: %s, err is %v", forwardAddr.Addr, err)
		return url, nil
	}
	consumeDuration := time.Since(startTime)
	glog.Info("Successfully got instance in %v, count: %d", consumeDuration, len(getInstResp.Instances))

	targetInstance := getInstResp.Instances[0]
	host := targetInstance.GetHost()
	port := targetInstance.GetPort()
	glog.Info("Selected instance: id=%s, address=%s:%d", targetInstance.GetId(), host, port)

	url = "http://" + host + ":" + strconv.FormatUint(uint64(port), 10)
	polarisCallback(targetInstance, consumeDuration)

	return url, nil
}

func polarisCallback(targetInstance pmodel.Instance, consumeDuration time.Duration) {
	svcCallResult := &api.ServiceCallResult{}
	svcCallResult.SetCalledInstance(targetInstance)
	svcCallResult.SetRetStatus(api.RetSuccess)
	svcCallResult.SetRetCode(0)
	svcCallResult.SetDelay(consumeDuration)
	err := consumerApi.UpdateServiceCallResult(svcCallResult)
	if err != nil {
		glog.Info("Fail to UpdateServiceCallResult, err is %v", err)
	}
}

func diff(request, oldResp, newResp, url string, diffBody *server.DiffBody, addr *model.ForwardAddr) {
	glog.Debug("start diff response...")
	isDifferent := handler.Compare(request, oldResp, newResp)
	if isDifferent {
		glog.Info("Diff detected, request = %s, oldResp = %s, newResp = %s, actual url = %s, diffBody = %s",
			request, oldResp, newResp, url, getJsonString(diffBody))
		return
	}
	glog.Debug("No different. new response: %s, old response: %s, url: %s", newResp, oldResp, url)
}

func (u *udpServer) decodeLog(req []byte) (*server.DiffBody, error) {
	reqLog := &stat.Log{}
	err := proto.Unmarshal(req, reqLog)
	if err != nil {
		return nil, err
	}
	if len(reqLog.GetModule()) == 0 {
		return nil, errors.New("illegal uin or module")
	}
	if len(reqLog.GetProduct()) == 0 {
		arrAction := strings.Split(strings.TrimSpace(reqLog.GetAction()), ":")
		if len(arrAction) == 2 {
			*reqLog.Product = arrAction[0]
			*reqLog.Action = arrAction[1]
		}
	}
	glog.Debug("decode log, the req log: %s", util.GetJsonStr(reqLog))
	if len(reqLog.GetProduct()) == 0 || len(reqLog.GetAction()) == 0 {
		return nil, errors.New("illegal product or action")
	}
	var tmp map[string]interface{}
	if err := json.Unmarshal([]byte(reqLog.GetRequest()), &tmp); err != nil {
		return nil, errors.New("illegal request")
	}
	if err := json.Unmarshal([]byte(reqLog.GetResponse()), &tmp); err != nil {
		return nil, errors.New("illegal response")
	}
	pBody := &server.DiffBody{
		Timestamp: int64(reqLog.GetTimestamp()),
		Module:    reqLog.GetModule(),
		Uin:       reqLog.GetUin(),
		Product:   reqLog.GetProduct(),
		Action:    reqLog.GetAction(),
		Request:   reqLog.GetRequest(),
		Response:  reqLog.GetResponse(),
	}
	return pBody, nil
}

func (u *udpServer) filterRequestAndReapplyIfMatch(diffBody *server.DiffBody) bool {
	for _, rule := range u.RuleConfigs.FilterRules {
		if u.matchRule(diffBody, rule) {
			glog.Info("Match rule (rule-id = %s), body: %s", rule.ID, getJsonString(diffBody))
			channel <- &forwardData{diffBody, &rule}
			return true
		}
		glog.Debug("Not match rule (rule-id = %s), body: %s", rule.ID, getJsonString(diffBody))
	}
	return false
}

func (u *udpServer) matchRule(diffBody *server.DiffBody, rule model.FilterRule) bool {
	if len(rule.Modules) != 0 && !u.matchField(diffBody.Module, rule.Modules) {
		glog.Debug("modules not match, rule id: %s, body: %s, rule modules: %s", rule.ID, getJsonString(diffBody), getJsonString(rule.Modules))
		return false
	}
	if len(rule.Products) != 0 && !u.matchField(diffBody.Product, rule.Products) {
		glog.Debug("products not match, rule id: %s, body: %s, rule products: %s", rule.ID, getJsonString(diffBody), getJsonString(rule.Products))
		return false
	}
	if len(rule.UinList) != 0 && !u.matchField(strconv.FormatUint(diffBody.Uin, 10), rule.UinList) {
		glog.Debug("uin not match, rule id: %s, body: %s, rule uin list: %s", rule.ID, getJsonString(diffBody), getJsonString(rule.UinList))
		return false
	}
	request := diffBody.Request
	var requestPkg model.RequestPkg
	err := json.Unmarshal([]byte(request), &requestPkg)
	if err != nil {
		glog.Error("Unmarshal request error while matching rule on field [action], err: %v", err)
		return false
	}
	if len(requestPkg.Interface.InterfaceName) != 0 && !u.matchField(requestPkg.Interface.InterfaceName, rule.Actions) {
		glog.Debug("actions not match, rule id: %s, body: %s, rule actions: %s", rule.ID, getJsonString(diffBody), getJsonString(rule.Actions))
		return false
	}
	return true
}

func (u *udpServer) matchField(requestField string, ruleFields []string) bool {
	for _, ruleField := range ruleFields {
		match, err := u.RuleMatcher.Match(requestField, ruleField)
		if err != nil {
			glog.Info("Match field error, err: %v", err)
			continue
		}
		if match {
			return true
		}
	}
	return false
}

func loadConfig() (*model.UdpConfig, *model.RuleConfig, error) {
	// return loadConfigFromPath("config/idc/rainbow/udp.yaml", "config/idc/rainbow/rule.yaml")
	return loadConfigFromPath("config/idc/udp.yaml", "config/idc/rule.yaml")
}

func loadConfigFromPath(udpConfigPath, ruleConfigPath string) (*model.UdpConfig, *model.RuleConfig, error) {
	log.Printf("Loading config from %s and %s\n", udpConfigPath, ruleConfigPath)

	var udpConfig model.UdpConfig
	var ruleConfigs model.RuleConfig

	udpConfigFile, err := os.ReadFile(udpConfigPath)
	if err != nil {
		log.Printf("Load udp server config file error, err: %v\n", err)
		return nil, nil, err
	}

	err = yaml.Unmarshal(udpConfigFile, &udpConfig)
	if err != nil {
		log.Printf("Unmarshal udpConfigFile error, err: %v\n", err)
		return nil, nil, err
	}

	udpBody, err := json.Marshal(udpConfig)
	if err != nil {
		log.Printf("Marshal udpBody error, err: %v\n", err)
		return nil, nil, err
	}
	log.Printf("UDP config: %s\n", string(udpBody))

	filterConfigFile, err := os.ReadFile(ruleConfigPath)
	if err != nil {
		log.Printf("Load filter rule config file error, err: %v\n", err)
		return nil, nil, err
	}

	err = yaml.Unmarshal(filterConfigFile, &ruleConfigs)
	if err != nil {
		log.Printf("Unmarshal filterConfigFile error, err: %v\n", err)
		return nil, nil, err
	}

	return &udpConfig, &ruleConfigs, nil
}

func (u *udpServer) reloadConfig() {
	udpConfig, ruleConfig, err := loadConfig()
	if err != nil {
		glog.Info("Reload configuration error: %v", err)
		return
	}
	u.UdpConfig = udpConfig
	u.RuleConfigs = ruleConfig

	activeKeys := make(map[string]struct{})
	for _, rule := range ruleConfig.FilterRules {
		if rule.QPS > 0 {
			u.LimiterManager.UpdateLimiter(rule.ID, rule.QPS)
			activeKeys[rule.ID] = struct{}{}
		}
	}
	u.LimiterManager.Cleanup(activeKeys)
}

func (u *udpServer) listenReloadConfigSignal() {
	http.HandleFunc("/reload", func(w http.ResponseWriter, r *http.Request) {
		u.reloadConfig()
		w.WriteHeader(http.StatusOK)
		_, err := w.Write([]byte("Configuration reloaded successfully"))
		if err != nil {
			glog.Info("Write response error: %v", err)
			return
		}
	})
	port := "8089"
	glog.Info("Starting config reload listener on :%s", port)
	if err := http.ListenAndServe(":"+port, nil); err != nil {
		glog.Info("Failed to start config reload server: %v", err)
	}
	glog.Info("Config reload listener shutdown")
}

func (u *udpServer) consumeAndReapply() {
	for data := range channel {
		if data.rule.QPS >= 0 {
			limiter := u.LimiterManager.GetLimiter(data.rule.ID, data.rule.QPS)
			if !limiter.Allow() {
				glog.Debug("Drop request due to rate limit, rule id: %s", data.rule.ID)
				continue
			}
			glog.Debug("Request passed rate limit, rule id: %s", data.rule.ID)
		}
		glog.Debug("forward data: %s", getJsonString(data.diffBody))
		u.forward(data.diffBody, data.rule)
	}
}

func initLoggerFromConfig(logConfig model.LogConfig) (*logger.Logger, error) {
	// 解析日志级别
	level, err := logger.ParseLogLevel(logConfig.Level)
	if err != nil {
		// 如果解析失败，使用默认INFO级别并记录警告
		level = logger.INFO
		fmt.Printf("WARN: Invalid log level '%s', using default INFO level\n", logConfig.Level)
	}

	// 创建基础配置
	config := logger.Config{
		Level:      level,
		LogDir:     logConfig.LogDir,
		MaxSize:    logConfig.MaxSize,
		MaxAge:     logConfig.MaxAge,
		MaxBackups: logConfig.MaxBackups,
		Compress:   logConfig.Compress,
		Async:      logConfig.Async,
		QueueSize:  logConfig.QueueSize,
	}

	// 获取默认配置
	finalConfig := logger.DefaultConfig()

	// 4. 合并配置项 (使用传入配置覆盖默认配置)
	if config.Level != finalConfig.Level {
		finalConfig.Level = config.Level
	}
	if config.LogDir != "" {
		finalConfig.LogDir = config.LogDir
	}
	if config.MaxSize > 0 {
		finalConfig.MaxSize = config.MaxSize
	}
	if config.MaxAge > 0 {
		finalConfig.MaxAge = config.MaxAge
	}
	if config.MaxBackups > 0 {
		finalConfig.MaxBackups = config.MaxBackups
	}
	// Compress 和 Async 是布尔值，只要配置中有设置就覆盖
	if logConfig.Compress {
		finalConfig.Compress = true
	}
	if logConfig.Async {
		finalConfig.Async = true
	} else {
		finalConfig.Async = false
	}
	if config.QueueSize > 0 {
		finalConfig.QueueSize = config.QueueSize
	}

	// 验证最终配置
	if err := validateLogConfig(finalConfig); err != nil {
		return nil, fmt.Errorf("invalid log configuration: %w", err)
	}

	// 创建日志记录器
	return logger.NewLogger(finalConfig)
}

func validateLogConfig(config logger.Config) error {
	if config.LogDir == "" {
		return fmt.Errorf("log directory cannot be empty")
	}
	if config.MaxSize <= 0 {
		return fmt.Errorf("max size must be positive")
	}
	if config.MaxAge < 0 {
		return fmt.Errorf("max age cannot be negative")
	}
	if config.MaxBackups < 0 {
		return fmt.Errorf("max backups cannot be negative")
	}
	if config.QueueSize < 0 {
		return fmt.Errorf("queue size cannot be negative")
	}
	return nil
}

type diffEventHandler struct{}

func (c *diffEventHandler) Decode(req []byte) (*server.DiffBody, error) {
	l := &stat.Log{}
	err := proto.Unmarshal(req, l)
	if err != nil {
		return nil, err
	}
	if l.GetUin() == 0 || l.GetSubAccountUin() == 0 || len(l.GetModule()) == 0 {
		return nil, errors.New("illegal uin or module")
	}
	if len(l.GetProduct()) == 0 {
		arrAction := strings.Split(strings.TrimSpace(l.GetAction()), ":")
		if len(arrAction) == 2 {
			*l.Product = arrAction[0]
			*l.Action = arrAction[1]
		}
	}
	if len(l.GetProduct()) == 0 || len(l.GetAction()) == 0 {
		return nil, errors.New("illegal product or action")
	}
	var tmp map[string]interface{}
	if err := json.Unmarshal([]byte(l.GetRequest()), &tmp); err != nil {
		return nil, errors.New("illegal request")
	}
	if err := json.Unmarshal([]byte(l.GetResponse()), &tmp); err != nil {
		return nil, errors.New("illegal response")
	}
	pBody := &server.DiffBody{
		Timestamp: int64(l.GetTimestamp()),
		Module:    l.GetModule(),
		Uin:       l.GetUin(),
		Product:   l.GetProduct(),
		Action:    l.GetAction(),
		Request:   l.GetRequest(),
		Response:  l.GetResponse(),
	}
	return pBody, nil
}

func (c *diffEventHandler) Compare(request, response, diffResponse string) bool {
	var diffRsp map[string]interface{}
	if err := json.Unmarshal([]byte(diffResponse), &diffRsp); err != nil {
		return false
	}
	diffData, ok := diffRsp["data"].(map[string]interface{})
	if !ok {
		return false
	}
	var diffOwnerUin, diffUin, diffOwnerAppid, diffReturnCode float64
	var diffPass, diffNeedAcl, diffIsAuthenticationUser float64
	if tmp, ok := diffData["ownerUin"].(float64); ok {
		diffOwnerUin = tmp
	}
	if tmp, ok := diffData["uin"].(float64); ok {
		diffUin = tmp
	}
	if tmp, ok := diffData["ownerUin"].(float64); ok {
		diffOwnerAppid = tmp
	}
	if tmp, ok := diffData["ownerAppid"].(float64); ok {
		diffOwnerAppid = tmp
	}
	if tmp, ok := diffRsp["returnCode"].(float64); ok {
		diffReturnCode = tmp
	}
	if tmp, ok := diffData["pass"].(float64); ok {
		diffPass = tmp
	}
	if tmp, ok := diffData["needAcl"].(float64); ok {
		diffNeedAcl = tmp
	}
	if tmp, ok := diffData["isAuthenticationUser"].(float64); ok {
		diffIsAuthenticationUser = tmp
	}

	var rsp map[string]interface{}
	if err := json.Unmarshal([]byte(response), &rsp); err != nil {
		return false
	}
	data, ok := rsp["data"].(map[string]interface{})
	if !ok {
		return false
	}
	var ownerUin, uin, ownerAppid, returnCode float64
	var pass, needAcl, isAuthenticationUser float64
	if tmp, ok := data["ownerUin"].(float64); ok {
		ownerUin = tmp
	}
	if tmp, ok := data["uin"].(float64); ok {
		uin = tmp
	}
	if tmp, ok := data["ownerUin"].(float64); ok {
		ownerAppid = tmp
	}
	if tmp, ok := data["ownerAppid"].(float64); ok {
		ownerAppid = tmp
	}
	if tmp, ok := rsp["returnCode"].(float64); ok {
		returnCode = tmp
	}
	if tmp, ok := data["pass"].(float64); ok {
		pass = tmp
	}
	if tmp, ok := data["needAcl"].(float64); ok {
		needAcl = tmp
	}
	if tmp, ok := data["isAuthenticationUser"].(float64); ok {
		isAuthenticationUser = tmp
	}

	var reqInfo map[string]interface{}
	if err := json.Unmarshal([]byte(request), &reqInfo); err != nil {
		return false
	}
	var migration float64
	if inter, ok := reqInfo["interface"].(map[string]interface{}); ok {
		if para, ok := inter["para"].(map[string]interface{}); ok {
			if tmpMigration, ok := para["migration"].(float64); ok {
				migration = tmpMigration
			}
		}
	}
	if migration == 1 {
		if (diffReturnCode == 0 || diffReturnCode == 11008) && (returnCode == 0 || returnCode == 11008) {
			if diffReturnCode == returnCode && diffOwnerUin == ownerUin && diffUin == uin &&
				diffOwnerAppid == ownerAppid && diffPass == pass && diffNeedAcl == needAcl &&
				diffIsAuthenticationUser == isAuthenticationUser {
				return true
			}
		} else if diffReturnCode == returnCode {
			return true
		}
	} else {
		if diffReturnCode == returnCode && diffOwnerUin == ownerUin &&
			diffUin == uin && diffOwnerAppid == ownerAppid {
			return true
		}
	}
	return false
}

func getJsonString(data interface{}) string {
	b, err := json.Marshal(data)
	if err != nil {
		return ""
	}
	return string(b)
}
prompt：帮我做一个可以自动从b站拉取视频，输入bv号，然后提取音频，用ffmpeg转换aac格式为flac的应用


PageRender

目前有几个问题：
1. mode2鉴权是什么意思？ url鉴权 已解决
2. 当前接口sigAndAuth的作用是？ 鉴权 已解决
3. 在敏捷开发中，user story，即用户故事，是一种表达需求的方式。
关于helix
4. tapd不是内部工具吗，为什么会在helix上用到
5. tiny push是什么
6. helix表演者， AISW，ai software，前后台关系
7. 文档里的翻译是指什么


--- 

目前的几个主要流程
1. 过滤需求、生成名称
2. 循环反思生成最小产品功能分析，记录循环轮次
3. 根据依赖的原子能力推断原子函数、U型管结构
4. 判断是否有Mock函数，生成U型管结构，生成建表sql
5. 循环对每个API生成cutom和dml代码，合并到工程代码
6. 生成前端代码，编译部署、反思
7. 验收
exception：step5出现问题 --> 运行时故障修复 --> 结束

--- 
1. cam_diff的bug修复：Action匹配、连续热重启
2. 内部接口分类分级改了Prompt跑了第二版的接口文档的数据
3. 改造cam_diff客户端，根据req、rsp包构造mode2鉴权请求去刷缓存
4. 跟进需要找日志的需求，去cls、tdw捞日志数据
5. 了解helix，目前了解了一下helix的流程，对比一下不同模型在U型管数据结构生成API代码的效果；

--- 

1. 需求分析
 1. 生成应用名称
 2. 最小产品功能分析
 3. 需求扩写
 4. 关联实体
2. 初始化部署资源
3. API依赖分析
  1. API依赖分析
  2. 原子能力集成
4. 调用关系图谱生成
  1. 调用关系图谱生成
5. 数据依赖分析
6. 生成代码、部署编译(这一步会有多个提问内容)

```plaintext
function =》 encoder，decoder
source =》 入参
channel =》 数据实体
logic =》 function内部实现逻辑
```